<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rong Xu">
<meta name="author" content="Rachael E Quill (Mentor)">
<meta name="dcterms.date" content="2025-11-03">

<title>Modeling Weather-Dependent Electricity Demand in Victoria Using Generalized Additive Mixed Models (GAMMs)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="report_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_files/libs/quarto-html/quarto.js"></script>
<script src="report_files/libs/quarto-html/popper.min.js"></script>
<script src="report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="report_files/libs/quarto-html/anchor.min.js"></script>
<link href="report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>
<script src="report_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="report_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#abstract" id="toc-abstract" class="nav-link active" data-scroll-target="#abstract"><span class="header-section-number">1</span> Abstract</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">2</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background"><span class="header-section-number">2.1</span> Background</a></li>
  <li><a href="#literature-context" id="toc-literature-context" class="nav-link" data-scroll-target="#literature-context"><span class="header-section-number">2.2</span> Literature Context</a></li>
  <li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation"><span class="header-section-number">2.3</span> Motivation</a></li>
  <li><a href="#sec-objectives" id="toc-sec-objectives" class="nav-link" data-scroll-target="#sec-objectives"><span class="header-section-number">2.4</span> Objectives</a></li>
  <li><a href="#significance" id="toc-significance" class="nav-link" data-scroll-target="#significance"><span class="header-section-number">2.5</span> Significance</a></li>
  </ul></li>
  <li><a href="#sec-data" id="toc-sec-data" class="nav-link" data-scroll-target="#sec-data"><span class="header-section-number">3</span> Data and Pre-processing</a>
  <ul class="collapse">
  <li><a href="#data-sources" id="toc-data-sources" class="nav-link" data-scroll-target="#data-sources"><span class="header-section-number">3.1</span> Data Sources</a></li>
  <li><a href="#data-processing-and-quality-checks" id="toc-data-processing-and-quality-checks" class="nav-link" data-scroll-target="#data-processing-and-quality-checks"><span class="header-section-number">3.2</span> Data Processing and Quality Checks</a>
  <ul class="collapse">
  <li><a href="#data-integration" id="toc-data-integration" class="nav-link" data-scroll-target="#data-integration"><span class="header-section-number">3.2.1</span> Data Integration</a></li>
  <li><a href="#data-cleaning-and-validation" id="toc-data-cleaning-and-validation" class="nav-link" data-scroll-target="#data-cleaning-and-validation"><span class="header-section-number">3.2.2</span> Data Cleaning and Validation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sec-EDA" id="toc-sec-EDA" class="nav-link" data-scroll-target="#sec-EDA"><span class="header-section-number">4</span> Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#demand-trends-and-seasonality" id="toc-demand-trends-and-seasonality" class="nav-link" data-scroll-target="#demand-trends-and-seasonality"><span class="header-section-number">4.1</span> Demand Trends and Seasonality</a></li>
  <li><a href="#weather-station-relationships-and-pca-unification" id="toc-weather-station-relationships-and-pca-unification" class="nav-link" data-scroll-target="#weather-station-relationships-and-pca-unification"><span class="header-section-number">4.2</span> Weather Station Relationships and PCA Unification</a></li>
  <li><a href="#temperature-feature-construction" id="toc-temperature-feature-construction" class="nav-link" data-scroll-target="#temperature-feature-construction"><span class="header-section-number">4.3</span> Temperature Feature Construction</a></li>
  <li><a href="#sec-feature-engineering" id="toc-sec-feature-engineering" class="nav-link" data-scroll-target="#sec-feature-engineering"><span class="header-section-number">4.4</span> Weather–Dependent Seasonal and Intraday Demand Patterns</a></li>
  <li><a href="#local-season-clustering-via-gmm" id="toc-local-season-clustering-via-gmm" class="nav-link" data-scroll-target="#local-season-clustering-via-gmm"><span class="header-section-number">4.5</span> Local Season Clustering via GMM</a></li>
  <li><a href="#feature-engineering-summary" id="toc-feature-engineering-summary" class="nav-link" data-scroll-target="#feature-engineering-summary"><span class="header-section-number">4.6</span> Feature Engineering Summary</a></li>
  </ul></li>
  <li><a href="#sec-Methodology" id="toc-sec-Methodology" class="nav-link" data-scroll-target="#sec-Methodology"><span class="header-section-number">5</span> Methodology</a>
  <ul class="collapse">
  <li><a href="#model-specification" id="toc-model-specification" class="nav-link" data-scroll-target="#model-specification"><span class="header-section-number">5.1</span> Model Specification</a></li>
  <li><a href="#model-training-and-validation" id="toc-model-training-and-validation" class="nav-link" data-scroll-target="#model-training-and-validation"><span class="header-section-number">5.2</span> Model Training and Validation</a></li>
  </ul></li>
  <li><a href="#sec-results" id="toc-sec-results" class="nav-link" data-scroll-target="#sec-results"><span class="header-section-number">6</span> Results</a>
  <ul class="collapse">
  <li><a href="#sec-model-comparison" id="toc-sec-model-comparison" class="nav-link" data-scroll-target="#sec-model-comparison"><span class="header-section-number">6.1</span> Comparison with different verions</a></li>
  <li><a href="#model-evaluation-best-performing-model-tmean_pcatrange_pca-with-local-season" id="toc-model-evaluation-best-performing-model-tmean_pcatrange_pca-with-local-season" class="nav-link" data-scroll-target="#model-evaluation-best-performing-model-tmean_pcatrange_pca-with-local-season"><span class="header-section-number">6.2</span> Model Evaluation — Best Performing Model (Tmean_pca/Trange_pca with Local Season)</a></li>
  <li><a href="#sec-gamm-heteroskedasticity" id="toc-sec-gamm-heteroskedasticity" class="nav-link" data-scroll-target="#sec-gamm-heteroskedasticity"><span class="header-section-number">6.3</span> Extending to GAMM: Addressing Heteroskedasticity</a></li>
  <li><a href="#out-of-sample-forecasts" id="toc-out-of-sample-forecasts" class="nav-link" data-scroll-target="#out-of-sample-forecasts"><span class="header-section-number">6.4</span> Out-of-sample forecasts</a></li>
  <li><a href="#sec-Interpretation-of-Model-Components" id="toc-sec-Interpretation-of-Model-Components" class="nav-link" data-scroll-target="#sec-Interpretation-of-Model-Components"><span class="header-section-number">6.5</span> Interpretation of Model Components</a></li>
  </ul></li>
  <li><a href="#sec-discussion" id="toc-sec-discussion" class="nav-link" data-scroll-target="#sec-discussion"><span class="header-section-number">7</span> Discussion</a>
  <ul class="collapse">
  <li><a href="#meeting-the-objectives" id="toc-meeting-the-objectives" class="nav-link" data-scroll-target="#meeting-the-objectives"><span class="header-section-number">7.1</span> Meeting the objectives</a></li>
  <li><a href="#contributions-and-novelty" id="toc-contributions-and-novelty" class="nav-link" data-scroll-target="#contributions-and-novelty"><span class="header-section-number">7.2</span> Contributions and novelty</a></li>
  <li><a href="#practical-implications" id="toc-practical-implications" class="nav-link" data-scroll-target="#practical-implications"><span class="header-section-number">7.3</span> Practical implications</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations"><span class="header-section-number">7.4</span> Limitations</a></li>
  <li><a href="#future-work" id="toc-future-work" class="nav-link" data-scroll-target="#future-work"><span class="header-section-number">7.5</span> Future work</a></li>
  </ul></li>
  <li><a href="#sec-conclusion" id="toc-sec-conclusion" class="nav-link" data-scroll-target="#sec-conclusion"><span class="header-section-number">8</span> Conclusion</a></li>
  <li><a href="#appendix-appendices" id="toc-appendix-appendices" class="nav-link" data-scroll-target="#appendix-appendices">(APPENDIX) Appendices</a>
  <ul class="collapse">
  <li><a href="#app-gamm-terms" id="toc-app-gamm-terms" class="nav-link" data-scroll-target="#app-gamm-terms"><span class="header-section-number">8.1</span> (APPENDIX A) Full GAMM Term Extraction</a></li>
  <li><a href="#app-gamm-smooths" id="toc-app-gamm-smooths" class="nav-link" data-scroll-target="#app-gamm-smooths"><span class="header-section-number">8.2</span> (APPENDIX B) Full GAMM Smooth Plots</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="report.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Modeling Weather-Dependent Electricity Demand in Victoria Using Generalized Additive Mixed Models (GAMMs)</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Rong Xu </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Monash University
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Rachael E Quill (Mentor) </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            State Electricity Commission Victoria
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 3, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="abstract" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Abstract</h1>
<p>Accurate electricity demand forecasting is critical for power system planning, operation, and reliability—particularly as the relationship between demand and weather evolves under the influence of climate variability and the growth of behind-the-meter renewable generation.</p>
<p>This project develops a weather-dependent load forecasting framework for Victoria (Australia). The model integrates electricity demand, meteorological, and rooftop solar data from the Australian Energy Market Operator (AEMO), Bureau of Meteorology (BoM), and Clean Energy Regulator (CER). Half-hourly grid demand is aggregated to daily totals and merged with temperature and solar exposure from three meteorological stations.</p>
<p>To capture a unified weather signal, Principal Component Analysis (PCA) removes spatial redundancy and extracts dominant temperature and solar drivers. In parallel, a Gaussian Mixture Model (GMM) defines local weather-based seasons, providing a data-driven alternative to fixed calendar seasons.</p>
<p>A Generalized Additive Mixed Model (GAMM) predicts daily electricity demand as a nonlinear function of temperature, temperature range, and solar exposure, while accounting for calendar effects and autocorrelation. The model captures key nonlinearities—such as the U-shaped temperature–demand relationship and asymmetric solar effects linked to rooftop PV saturation.</p>
<p>Empirical results show strong performance, achieving R² ≈ 0.94 and MAPE ≈ 3.28% (<a href="#fig-gamm-forecast" class="quarto-xref">Figure&nbsp;12</a>) on out-of-sample data. Overall, the interpretable and adaptive GAMM framework enhances short-term forecasting capability and supports the State Electricity Commission (SEC) Victoria in data-driven planning that incorporates weather variability and solar exposure effects associated with distributed PV.</p>
<p>All analysis and modeling were conducted in R, primarily using the <code>tidyverse</code> for data manipulation, <code>mclust</code> for GMM clustering, and <code>mgcv</code> for GAMM modeling. Custom R scripts were written for data integration, feature engineering, and evaluation, with results visualized using <code>ggplot2</code>.</p>
<p>The full analysis and reproducible workflow are available on GitHub<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. As discussed in Section <a href="#sec-discussion" class="quarto-xref">Section&nbsp;7</a>, the reproducible scripts on GitHub enable further experimentation.</p>
</section>
<section id="introduction" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Introduction</h1>
<p>Electricity load forecasting is a cornerstone of modern energy management, underpinning operational planning, market bidding, and infrastructure development. As renewable integration and weather variability intensify, accurate demand forecasts have become more critical than ever. Among all influencing factors, weather conditions are among the most dominant drivers of short-term electricity consumption. Temperature extremes(very hot or cold days)trigger surges in cooling or heating demand, while mild weather suppresses overall usage. Solar radiation and related climatic variables also shape consumer behavior and net grid demand, particularly through rooftop photovoltaic (PV) generation and air conditioning patterns.</p>
<p>In contemporary power systems, the increasing penetration of renewable and distributed energy resources amplifies the need to explicitly account for these weather–demand interactions. Traditional time-series models effectively capture temporal autocorrelation but often overlook exogenous weather influences, whereas purely regression-based or machine learning models can incorporate weather data yet struggle with nonlinear relationships and multicollinearity among predictors.</p>
<p>To address these challenges, this report explores an advanced approach that integrates time-series structure with nonlinear weather effects, aiming to enhance both forecast accuracy and interpretability for daily electricity demand in Victoria, Australia, focusing on Melbourne and surrounding regions.</p>
<section id="background" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="background"><span class="header-section-number">2.1</span> Background</h2>
<p>Victoria’s electricity system is undergoing a structural transformation driven by decarbonisation policy, renewable investment, and rapid household PV adoption. The State Electricity Commission (SEC) of Victoria, re-established in 2023, plays a central role in this transition as a government-owned energy company focused on accelerating renewable investment, supporting household electrification, and building Victoria’s renewable energy workforce. Since the launch of the Solar Homes Program in 2018, rooftop PV installations across Victoria have expanded rapidly, contributing to increasingly irregular grid-level demand patterns. This shift signifies a broader structural transformation in how economic activity translates into electricity consumption. Weather has long been a dominant determinant of electricity demand; however, its impact has now changed, reflecting growing behavioural and structural sensitivities driven by behind-the-meter renewables—particularly rooftop PV—and the ongoing process of electrification. Consequently, load profiles have become more responsive to climatic and behavioural factors than ever before.</p>
</section>
<section id="literature-context" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="literature-context"><span class="header-section-number">2.2</span> Literature Context</h2>
<p>In this project, daily demand is modelled instead of half-hourly load to focus on broader weather-driven trends while mitigating short-term noise related to intraday variability.</p>
<p>Modern forecasting approaches, including machine learning (ML) and advanced statistical models, are increasingly applied to capture nonlinear relationships between weather and electricity demand <span class="citation" data-cites="Misiurek2025">(<a href="#ref-Misiurek2025" role="doc-biblioref">Misiurek, Olkuski, and Zyśk 2025</a>)</span>. However, these data-driven methods often lack interpretability, which limits their usefulness for understanding the underlying drivers of energy-system change <span class="citation" data-cites="Baur2024">(<a href="#ref-Baur2024" role="doc-biblioref">Baur et al. 2024</a>)</span>.</p>
<p>In contrast, Generalized Additive Models (GAMs) and their extension, Generalized Additive Mixed Models (GAMMs), balance flexibility with transparency by allowing smooth nonlinear effects of predictors such as temperature and solar exposure while preserving interpretability of each variable’s contribution <span class="citation" data-cites="HastieTibshirani2017 Wood2017">(<a href="#ref-HastieTibshirani2017" role="doc-biblioref">Hastie and Tibshirani 2017</a>; <a href="#ref-Wood2017" role="doc-biblioref">Wood 2017</a>)</span>. The GAMM framework, implemented via the mgcv package in R <span class="citation" data-cites="Wood2017">(<a href="#ref-Wood2017" role="doc-biblioref">Wood 2017</a>)</span>, further accounts for correlated errors and hierarchical effects through the inclusion of random effects or correlation structures—particularly relevant for daily aggregated demand data, where residuals may exhibit temporal dependence due to persistent weather and behavioural factors.</p>
<p>Applications of GAM-based models have therefore gained popularity in load forecasting because they bridge the gap between accuracy and interpretability, providing insights that purely data-driven approaches cannot <span class="citation" data-cites="Fan2022 Misiurek2025">(<a href="#ref-Fan2022" role="doc-biblioref">Fan, Zhang, and Wang 2022</a>; <a href="#ref-Misiurek2025" role="doc-biblioref">Misiurek, Olkuski, and Zyśk 2025</a>)</span>.</p>
<p>To support such interpretable modeling, it is equally critical to construct representative and spatially consistent weather features. Historically, utility forecasters have incorporated weather variables — especially temperature into regression or time-series models to improve forecast accuracy. Those approaches often relied on a single representative weather station or used equal-weight averages across several nearby stations. Recent studies highlight more advanced techniques for integrating spatially distributed weather data, such as dimensionality reduction and unsupervised clustering of meteorological features <span class="citation" data-cites="Neumann2023">(<a href="#ref-Neumann2023" role="doc-biblioref">Neumann, Heine, and Fichtner 2023</a>)</span>. For example, Principal Component Analysis (PCA) can be used to construct a “virtual weather station” that summarises the dominant shared variation across multiple sites—capturing a unified temperature and solar signal that represents regional weather conditions <span class="citation" data-cites="Neumann2023">(<a href="#ref-Neumann2023" role="doc-biblioref">Neumann, Heine, and Fichtner 2023</a>)</span>.</p>
<p>In Australia, the Australian Energy Market Operator <span class="citation" data-cites="AEMO2024">(<a href="#ref-AEMO2024" role="doc-biblioref">AEMO 2024</a>)</span> has adopted weather-normalisation practices consistent with this rationale, underscoring the importance of interpretable models that can capture evolving climate and weather effects on electricity demand. There is a growing need for adaptive forecasting models that can represent how electricity-use patterns evolve with climate variability and increasing rooftop-solar adoption. As more households install PV systems, midday grid demand drops and evening peaks intensify—the well-known “duck-curve” effect—highlighting the importance of models that can dynamically represent these changing demand behaviours. Similarly, clustering approaches such as Gaussian Mixture Models (GMMs) can identify typical weather regimes or local seasons, helping to overcome the mismatch between calendar-based seasons and real energy-consumption behaviour <span class="citation" data-cites="Aquila2023">(<a href="#ref-Aquila2023" role="doc-biblioref">Aquila et al. 2023</a>)</span>.</p>
</section>
<section id="motivation" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="motivation"><span class="header-section-number">2.3</span> Motivation</h2>
<p>For energy market participants such as the State Electricity Commission (SEC) Victoria, accurate short- and medium-term electricity demand forecasting (short-term: up to two weeks; medium-term: up to one year) is critical for maintaining system reliability, supporting market bidding strategies, and guiding investment planning. Reliable forecasts underpin decisions on reserve allocation, energy procurement, and integration of renewable generation within the National Electricity Market (NEM). However, existing forecasting models often rely on static, linear relationships that fail to represent the evolving, nonlinear effects of weather and rooftop solar adoption on electricity demand. Hence,this study is motivated by SEC Victoria’s need for an adaptive and interpretable modelling framework that can quantify how weather and distributed generation jointly influence electricity demand while providing transparent insights to support evidence-based decision-making in the evolving energy market.</p>
</section>
<section id="sec-objectives" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="sec-objectives"><span class="header-section-number">2.4</span> Objectives</h2>
<p>The key research question guiding this study is: How can daily electricity demand be forecast more accurately and interpretably by incorporating weather dependencies and evolving solar impacts?</p>
<p>To address this question, the project pursues four high-level objectives aligned with SEC Victoria’s role as an energy market participant:</p>
<ul>
<li><p>Integrate regional weather information — consolidate temperature and solar data from multiple locations to represent Victoria’s dominant weather patterns. This enables SEC to better anticipate climate-driven fluctuations in demand across the state.</p></li>
<li><p>Characterize nonlinear thermal relationships — quantify how temperature and solar exposure jointly influence demand through heating and cooling effects. Understanding these nonlinear responses supports more reliable operational and market forecasts under extreme or changing weather conditions.</p></li>
<li><p>Define data-driven seasonal regimes — identify flexible, weather-based “local seasons” that align with actual energy-use behaviour rather than rigid calendar definitions. These insights improve SEC’s ability to interpret seasonal demand dynamics and manage forecasting under climate variability.</p></li>
<li><p>Develop an interpretable forecasting framework — build and evaluate a transparent, adaptive model that links weather, solar adoption, and behavioural patterns to electricity demand. The resulting framework enhances SEC’s analytical capability to forecast demand accurately, communicate insights clearly, and inform decisions on reliability planning, market participation, and renewable integration.</p></li>
</ul>
<p>The detailed exploratory analysis supporting these objectives is presented in <a href="#sec-EDA" class="quarto-xref">Section&nbsp;4</a>. Together, these objectives aim to deliver a transparent and adaptive forecasting framework with high predictive accuracy while deepening understanding of how weather and behavioural factors shape daily electricity demand — supporting the State Electricity Commission (SEC) Victoria in data-driven energy system planning.</p>
</section>
<section id="significance" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="significance"><span class="header-section-number">2.5</span> Significance</h2>
<p>Improving load forecast accuracy has tangible benefits for the State Electricity Commission (SEC) Victoria. Even small reductions in forecasting error can translate into substantial cost savings and operational efficiencies. The accuracy achieved by our weather-informed GAMM framework — yielding daily errors of only around 3–4% (R² ≈ 0.94)—is therefore of significant practical value. Beyond accuracy, the model provides interpretability by quantifying how temperature, solar exposure, and local seasonal regimes influence electricity demand. These insights help energy market decision-makers understand the impact of climate variability and rooftop PV adoption on energy consumption. This project was undertaken as part of a university capstone in collaboration with a government energy agency, highlighting its applied and policy-relevant significance.</p>
<p>The remainder of this report is organized as follows. <a href="#sec-data" class="quarto-xref">Section&nbsp;3</a> describes the data sources and preprocessing procedures used to construct the integrated demand–weather dataset. <a href="#sec-EDA" class="quarto-xref">Section&nbsp;4</a> presents the exploratory data analysis (EDA), highlighting key patterns and relationships that justify the adoption of local-season clustering and guide the feature engineering process that motivates the modelling approach. <a href="#sec-Methodology" class="quarto-xref">Section&nbsp;5</a> outlines the modelling framework and overall workflow of the Generalized Additive Mixed Model (GAMM), covering the processes of model fitting, evaluation, residual diagnostic checking, and forecasting. <a href="#sec-results" class="quarto-xref">Section&nbsp;6</a> summarizes the overall model fitting outcomes from <a href="#sec-Methodology" class="quarto-xref">Section&nbsp;5</a> and interprets the model components. Finally, <a href="#sec-discussion" class="quarto-xref">Section&nbsp;7</a> and <a href="#sec-conclusion" class="quarto-xref">Section&nbsp;8</a> present the principal findings, discuss implications for system planning, and identify limitations and directions for future improvement.</p>
</section>
</section>
<section id="sec-data" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data and Pre-processing</h1>
<section id="data-sources" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="data-sources"><span class="header-section-number">3.1</span> Data Sources</h2>
<p>We utilize three primary data sources covering July 1, 2013 through August 5, 2025:</p>
<ul>
<li><p>Electricity Demand Data: Region-wide half-hourly load data for Victoria were sourced from the Australian Energy Market Operator’s VIC1 Scheduled Demand dataset <span class="citation" data-cites="AEMO2024">(<a href="#ref-AEMO2024" role="doc-biblioref">AEMO 2024</a>)</span>. These measurements represent the total electrical demand drawn from the transmission grid, excluding behind-the-meter generation such as rooftop photovoltaic (PV) output and other non-scheduled, self-consumed renewable generation. In other words, the data reflect only grid-supplied demand after the impact of distributed solar generation has been netted out.</p></li>
<li><p>Weather Data: Daily meteorological observations were obtained from the Australian Bureau of Meteorology (BoM, 2024) for three representative stations in Victoria—Melbourne (Olympic Park), Morwell (Latrobe Valley east inland), and Ballarat (higher-altitude inland). For each station, we collected daily maximum temperature (Tmax, °C), minimum temperature (Tmin, °C), and global solar exposure (Solar, MJ/m²). These locations were selected to capture the state’s climatic diversity—urban coastal, valley inland, and elevated inland regions—and to ensure broad coverage of weather conditions that influence electricity demand. Importantly, these same stations are also used by AEMO for state-wide energy demand forecasting, providing alignment with established industry practice and enhancing the robustness of this study’s weather representation.</p></li>
<li><p>Rooftop PV data: Postcode-level PV installation capacity and system counts from the Clean Energy Regulator <span class="citation" data-cites="CER2024">(<a href="#ref-CER2024" role="doc-biblioref">Clean Energy Regulator (CER) 2024</a>)</span>. These data reflect the cumulative installed PV capacity (kW) and monthly installation growth since 2011.</p></li>
</ul>
<p>Together, these three datasets provide a comprehensive 12-year record linking Victoria’s electricity demand, meteorological variability, and rooftop solar adoption — forming the foundation for the exploratory analysis and modeling that follow.</p>
</section>
<section id="data-processing-and-quality-checks" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="data-processing-and-quality-checks"><span class="header-section-number">3.2</span> Data Processing and Quality Checks</h2>
<section id="data-integration" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="data-integration"><span class="header-section-number">3.2.1</span> Data Integration</h3>
<ul>
<li><p>Aggregation: Half-hourly AEMO demand data were summed across 48 intervals per day to produce daily total demand (MWh).</p></li>
<li><p>Alignment: Daily BoM weather variables (Tmax, Tmin, Solar exposure) were merged with demand data by date.</p></li>
<li><p>PV data integration (complementary): CER monthly rooftop PV capacity (kW) and installation counts (by postcode) were aggregated to the state level (Victoria) and incorporated as contextual data to indicate the structural shift in grid demand associated with rapid PV uptake<span class="citation" data-cites="AEC2019 ESC2025">(<a href="#ref-AEC2019" role="doc-biblioref">Australian Energy Council 2019</a>; <a href="#ref-ESC2025" role="doc-biblioref">Essential Services Commission 2025</a>)</span>. These data were not used as model inputs, but rather to inform period selection and interpretation.</p></li>
<li><p>The final integrated dataset spans 1 July 2013 – 30 June 2025, ensuring consistent temporal alignment across sources.</p></li>
</ul>
</section>
<section id="data-cleaning-and-validation" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="data-cleaning-and-validation"><span class="header-section-number">3.2.2</span> Data Cleaning and Validation</h3>
<p>Following these steps, the dataset was visually inspected and statistically verified for completeness and plausibility, providing a robust foundation for exploratory data analysis.</p>
<p>Before modeling, data consistency across sources was verified. The AEMO demand data were generally complete, but all entries were checked for irregularities such as negative values or implausible spikes. None of these anomalies were significant.</p>
<p>The weather station data contained a very small proportion of missing days (&lt;1%), mainly due to short sensor outages. A small number of missing daily weather readings (&lt;1%) were filled using linear interpolation (<code>zoo::na.approx()</code>), which is appropriate for short, continuous time series with smooth temporal variation.</p>
<p>After cleaning, all variables were visually inspected and statistically validated to confirm internal consistency and temporal alignment.</p>
</section>
</section>
</section>
<section id="sec-EDA" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Exploratory Data Analysis</h1>
<p>Following the integration and validation of all data sources, exploratory data analysis (EDA) was undertaken to uncover relationships and structural patterns that guided feature construction and model development.</p>
<section id="demand-trends-and-seasonality" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="demand-trends-and-seasonality"><span class="header-section-number">4.1</span> Demand Trends and Seasonality</h2>
<p>As shown in <a href="#fig-pv-two-panel" class="quarto-xref">Figure&nbsp;1</a>, Victoria’s grid-supplied demand (2014–2024) shows a slight overall decline, strong seasonality (winter heating and summer cooling peaks), and rising intra-season variability.</p>
<p>The left panel indicates a structural change around 2018–2019, coinciding with the rollout of the Victorian Solar Homes Program and rapid rooftop PV uptake. Since then, midday grid demand has flattened and within-year fluctuations have increased, reflecting the influence of behind-the-meter generation. The right panel confirms a regime shift: across all seasons, the PV–demand relationship has moved such that post-2019 observations exhibit lower grid demand for a given PV capacity than pre-2019.</p>
<p>Together, these patterns indicate a PV-influenced regime post-2019. To model the modern demand–weather dynamics and maintain stationarity, we define the modeling window as July 2019 – June 2025; earlier data are retained only for historical context and visualization.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pv-two-panel" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pv-two-panel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-pv-two-panel-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pv-two-panel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Solar PV Growth and Demand Patterns in Victoria (2014–2024). Left: Monthly demand trend with post-2019 structural shift; Right: PV–demand relationship by season (Pre- vs Post-2019).
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="weather-station-relationships-and-pca-unification" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="weather-station-relationships-and-pca-unification"><span class="header-section-number">4.2</span> Weather Station Relationships and PCA Unification</h2>
<p>As shown in <a href="#fig-vshape-stations" class="quarto-xref">Figure&nbsp;2</a>, daily electricity demand in Victoria exhibits a clear nonlinear (V-shaped) relationship with both Tmax and Tmin at Ballarat, Melbourne (Olympic Park), and Morwell. Demand rises under heat (cooling load) and cold (heating load) periods, and is lowest on mild days. Solar exposure shows a weaker, partly inverse association with demand, consistent with rooftop-PV offset on sunny days.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-vshape-stations" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-vshape-stations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-vshape-stations-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vshape-stations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Temperature and Solar Relationships with Electricity Demand
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#tbl-vif-summary" class="quarto-xref">Table&nbsp;1</a> indicates notable dependence between Tmax and Tmin (r ≈ 0.6–0.7) and moderately elevated VIFs, implying multicollinearity among raw station inputs. Since Victoria’s weather co-moves across sites, using all station variables risks unstable estimates.</p>
<div class="cell">
<div id="tbl-vif-summary" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-vif-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="xkrpdzlmsq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xkrpdzlmsq table {
  font-family: Arial;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xkrpdzlmsq thead, #xkrpdzlmsq tbody, #xkrpdzlmsq tfoot, #xkrpdzlmsq tr, #xkrpdzlmsq td, #xkrpdzlmsq th {
  border-style: none;
}

#xkrpdzlmsq p {
  margin: 0;
  padding: 0;
}

#xkrpdzlmsq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xkrpdzlmsq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xkrpdzlmsq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xkrpdzlmsq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xkrpdzlmsq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xkrpdzlmsq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xkrpdzlmsq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xkrpdzlmsq .gt_col_heading {
  color: #333333;
  background-color: #F2F2F2;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xkrpdzlmsq .gt_column_spanner_outer {
  color: #333333;
  background-color: #F2F2F2;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xkrpdzlmsq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xkrpdzlmsq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xkrpdzlmsq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xkrpdzlmsq .gt_spanner_row {
  border-bottom-style: hidden;
}

#xkrpdzlmsq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xkrpdzlmsq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xkrpdzlmsq .gt_from_md > :first-child {
  margin-top: 0;
}

#xkrpdzlmsq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xkrpdzlmsq .gt_row {
  padding-top: 6px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xkrpdzlmsq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xkrpdzlmsq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xkrpdzlmsq .gt_row_group_first td {
  border-top-width: 2px;
}

#xkrpdzlmsq .gt_row_group_first th {
  border-top-width: 2px;
}

#xkrpdzlmsq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xkrpdzlmsq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xkrpdzlmsq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xkrpdzlmsq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xkrpdzlmsq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xkrpdzlmsq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xkrpdzlmsq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xkrpdzlmsq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xkrpdzlmsq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xkrpdzlmsq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xkrpdzlmsq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xkrpdzlmsq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xkrpdzlmsq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xkrpdzlmsq .gt_left {
  text-align: left;
}

#xkrpdzlmsq .gt_center {
  text-align: center;
}

#xkrpdzlmsq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xkrpdzlmsq .gt_font_normal {
  font-weight: normal;
}

#xkrpdzlmsq .gt_font_bold {
  font-weight: bold;
}

#xkrpdzlmsq .gt_font_italic {
  font-style: italic;
}

#xkrpdzlmsq .gt_super {
  font-size: 65%;
}

#xkrpdzlmsq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xkrpdzlmsq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xkrpdzlmsq .gt_indent_1 {
  text-indent: 5px;
}

#xkrpdzlmsq .gt_indent_2 {
  text-indent: 10px;
}

#xkrpdzlmsq .gt_indent_3 {
  text-indent: 15px;
}

#xkrpdzlmsq .gt_indent_4 {
  text-indent: 20px;
}

#xkrpdzlmsq .gt_indent_5 {
  text-indent: 25px;
}

#xkrpdzlmsq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xkrpdzlmsq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="5" class="gt_heading gt_title gt_font_normal"><strong>Tmax–Tmin Correlation and Multicollinearity (VIF) Summary</strong></th>
</tr>
<tr class="odd gt_heading">
<th colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Correlation reflects linear dependence between Tmax and Tmin; VIF values assess multicollinearity among predictors (Tmax, Tmin, Solar).</th>
</tr>
<tr class="header gt_col_headings">
<th id="Station" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Weather Station</th>
<th id="Correlation" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Tmax–Tmin Corr.</th>
<th id="Tmax_VIF" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">VIF (Tmax)</th>
<th id="Tmin_VIF" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">VIF (Tmin)</th>
<th id="Solar_VIF" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">VIF (Solar)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Station">Ballarat Aerodrome</td>
<td class="gt_row gt_right" headers="Correlation">0.72</td>
<td class="gt_row gt_right" headers="Tmax_VIF">4.18</td>
<td class="gt_row gt_right" headers="Tmin_VIF">2.37</td>
<td class="gt_row gt_right" headers="Solar_VIF">2.27</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Station">Melbourne (Olympic Park)</td>
<td class="gt_row gt_right" headers="Correlation">0.69</td>
<td class="gt_row gt_right" headers="Tmax_VIF">2.60</td>
<td class="gt_row gt_right" headers="Tmin_VIF">1.93</td>
<td class="gt_row gt_right" headers="Solar_VIF">1.56</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Station">Morwell (Latrobe Valley)</td>
<td class="gt_row gt_right" headers="Correlation">0.58</td>
<td class="gt_row gt_right" headers="Tmax_VIF">2.77</td>
<td class="gt_row gt_right" headers="Tmin_VIF">1.58</td>
<td class="gt_row gt_right" headers="Solar_VIF">1.99</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-vif-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Tmax–Tmin Correlation and Multicollinearity (VIF) Summary. Correlation reflects dependence between Tmax and Tmin; VIF assesses multicollinearity among {Tmax, Tmin, Solar}.
</figcaption>
</figure>
</div>
</div>
<p>To address this, we apply Principal Component Analysis (PCA) to standardized station variables separately for Tmax, Tmin, and Solar. The first two components (PC1, PC2) explain ~ 87% of variance, capturing the statewide signal and inland–coastal contrasts. The resulting PCA-based weights (see in <a href="#tbl-pca-weights" class="quarto-xref">Table&nbsp;2</a>) quantify each station’s contribution to unified regional indices. Using PC1+PC2 loadings, we form <code>tmax_pca</code>, <code>tmin_pca</code>, and <code>solar_pca</code>, preserving key spatial structure while removing multicollinearity —- yielding more stable, interpretable weather inputs for modeling.</p>
<div class="cell">
<div id="tbl-pca-weights" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-pca-weights-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="pmblnimryt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pmblnimryt table {
  font-family: Arial;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pmblnimryt thead, #pmblnimryt tbody, #pmblnimryt tfoot, #pmblnimryt tr, #pmblnimryt td, #pmblnimryt th {
  border-style: none;
}

#pmblnimryt p {
  margin: 0;
  padding: 0;
}

#pmblnimryt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 80%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pmblnimryt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pmblnimryt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pmblnimryt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pmblnimryt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pmblnimryt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pmblnimryt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pmblnimryt .gt_col_heading {
  color: #333333;
  background-color: #F2F2F2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pmblnimryt .gt_column_spanner_outer {
  color: #333333;
  background-color: #F2F2F2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pmblnimryt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pmblnimryt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pmblnimryt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pmblnimryt .gt_spanner_row {
  border-bottom-style: hidden;
}

#pmblnimryt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pmblnimryt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pmblnimryt .gt_from_md > :first-child {
  margin-top: 0;
}

#pmblnimryt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pmblnimryt .gt_row {
  padding-top: 5px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pmblnimryt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pmblnimryt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pmblnimryt .gt_row_group_first td {
  border-top-width: 2px;
}

#pmblnimryt .gt_row_group_first th {
  border-top-width: 2px;
}

#pmblnimryt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pmblnimryt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pmblnimryt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pmblnimryt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pmblnimryt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pmblnimryt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pmblnimryt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pmblnimryt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pmblnimryt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pmblnimryt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pmblnimryt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pmblnimryt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pmblnimryt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pmblnimryt .gt_left {
  text-align: left;
}

#pmblnimryt .gt_center {
  text-align: center;
}

#pmblnimryt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pmblnimryt .gt_font_normal {
  font-weight: normal;
}

#pmblnimryt .gt_font_bold {
  font-weight: bold;
}

#pmblnimryt .gt_font_italic {
  font-style: italic;
}

#pmblnimryt .gt_super {
  font-size: 65%;
}

#pmblnimryt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pmblnimryt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pmblnimryt .gt_indent_1 {
  text-indent: 5px;
}

#pmblnimryt .gt_indent_2 {
  text-indent: 10px;
}

#pmblnimryt .gt_indent_3 {
  text-indent: 15px;
}

#pmblnimryt .gt_indent_4 {
  text-indent: 20px;
}

#pmblnimryt .gt_indent_5 {
  text-indent: 25px;
}

#pmblnimryt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pmblnimryt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="4" class="gt_heading gt_title gt_font_normal"><strong>PCA-Based Station Weights (PC1 + PC2 Combined)</strong></th>
</tr>
<tr class="odd gt_heading">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">PC1 = 68.5%, PC2 = 19.2% (Total = 87.6%)</th>
</tr>
<tr class="header gt_col_headings">
<th id="Station" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Weather Station</th>
<th id="Tmax" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">T<sub>max</sub></th>
<th id="Tmin" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">T<sub>min</sub></th>
<th id="Solar" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Solar (MJ/m²)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Station">Ballarat Aerodrome</td>
<td class="gt_row gt_right" headers="Tmax">0.334</td>
<td class="gt_row gt_right" headers="Tmin">0.343</td>
<td class="gt_row gt_right" headers="Solar">0.353</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Station">Melbourne (Olympic Park)</td>
<td class="gt_row gt_right" headers="Tmax">0.328</td>
<td class="gt_row gt_right" headers="Tmin">0.345</td>
<td class="gt_row gt_right" headers="Solar">0.321</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Station">Morwell (Latrobe Valley Airport)</td>
<td class="gt_row gt_right" headers="Tmax">0.338</td>
<td class="gt_row gt_right" headers="Tmin">0.312</td>
<td class="gt_row gt_right" headers="Solar">0.325</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-pca-weights-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: PCA-Based Station Weights (PC1 + PC2 Combined). PC1 and PC2 together explain ~87% of total variance.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="temperature-feature-construction" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="temperature-feature-construction"><span class="header-section-number">4.3</span> Temperature Feature Construction</h2>
<p>Accurately representing thermal conditions is essential for modeling electricity demand, as temperature strongly drives both heating and cooling behavior. While the PCA-derived variables (tmax_pca, tmin_pca, solar_pca) already capture unified, multicollinearity-free weather signals across stations, the high correlation between tmax_pca and tmin_pca suggests they still express a shared latent temperature factor. To obtain more interpretable and functionally relevant predictors for demand modeling, we therefore derived composite temperature indicators that summarize overall comfort, diurnal variability, and thermal stress beyond simple maximum and minimum temperatures.</p>
<p>These composite indicators, summarized in <a href="#tbl-temp-vars" class="quarto-xref">Table&nbsp;3</a>, are evaluated against the original PCA-derived temperatures to determine which construction best captures demand sensitivity.</p>
<div class="cell">
<div id="tbl-temp-vars" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-temp-vars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<table class="table table-striped table-hover table-condensed do-not-create-environment cell table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Derived.Variable</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Formula</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Interpretation...Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Tmean</td>
<td style="text-align: center; width: 6cm;">(Tmean = (Tmax_pca + Tmin_pca) / 2)</td>
<td style="text-align: center; width: 11cm;">Mean daily comfort temperature — represents the overall thermal level of each day, capturing both daytime and nighttime effects.</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Trange</td>
<td style="text-align: center; width: 6cm;">(Trange = Tmax_pca - Tmin_pca)</td>
<td style="text-align: center; width: 11cm;">Diurnal temperature spread — measures day–night variability; large values imply potential for both daytime cooling and nighttime heating.</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">HDD</td>
<td style="text-align: center; width: 6cm;">(HDD = max(0, 16.5 - Tmean_pca))</td>
<td style="text-align: center; width: 11cm;">Heating Degree Days (HDD) — quantifies heating demand when the mean temperature falls below 16.5 °C.(AEMO VIC threshold)</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">CDD</td>
<td style="text-align: center; width: 6cm;">(CDD = max(0, Tmean_pca - 18.0))</td>
<td style="text-align: center; width: 11cm;">Cooling Degree Days (CDD) — quantifies cooling demand when the mean temperature exceeds 18.0 °C.(AEMO VIC threshold)</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-temp-vars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Derived temperature variables based on PCA-combined station data and AEMO Victoria comfort thresholds (16.5 °C for heating, 18 °C for cooling)
</figcaption>
</figure>
</div>
</div>
<p><a href="#fig-temp-comparison" class="quarto-xref">Figure&nbsp;3</a> visualizes the correlation structures (top) and the corresponding nonlinear demand–temperature relationships (bottom). The results show that the three temperature formulations—mean–range composites and degree-day metrics—exhibit progressively lower inter-variable correlation, indicating reduced redundancy among thermal indicators. While Tmean effectively captures broad comfort-related variations, and Trange represents the diurnal amplitude of temperature, the HDD/CDD transformation isolates heating and cooling effects more explicitly. Notably, the HDD/CDD metrics display an almost linear association with electricity demand, consistent with AEMO’s empirical temperature–load response behavior for Victoria.</p>
<div class="cell" data-layout-align="center">
<div id="fig-temp-comparison" class="cell quarto-figure quarto-figure-center quarto-float anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-temp-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-temp-comparison" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-temp-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-temp-comparison-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" data-ref-parent="fig-temp-comparison">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-temp-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Top: Correlation matrices
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-temp-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Comparing Temperature Constructions and Their Relationships with Electricity Demand
</figcaption>
</figure>
</div>
</div>
<p>In <a href="#sec-model-comparison" class="quarto-xref">Section&nbsp;6.1</a>, we compare model variants that incorporate these thermal indicators—assessing their explanatory power, predictive accuracy, and ability to capture nonlinear seasonal behavior.</p>
</section>
<section id="sec-feature-engineering" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="sec-feature-engineering"><span class="header-section-number">4.4</span> Weather–Dependent Seasonal and Intraday Demand Patterns</h2>
<p>Over the most recent six years, Victoria’s electricity demand patterns have shifted markedly across seasons. To ensure consistency with AEMO’s reporting conventions, monthly averages in <a href="#fig-seasonal-intraday" class="quarto-xref">Figure&nbsp;4</a> (left) are plotted according to the AEMO season year (April–March) rather than the calendar year (January–December). As shown in <a href="#fig-seasonal-intraday" class="quarto-xref">Figure&nbsp;4</a> (left), winter demand has increased, reflecting stronger heating requirements and limited rooftop PV generation during shorter daylight hours. In contrast, demand during summer, spring, and autumn has declined overall, largely due to longer daylight periods and the growing impact of rooftop PV generation offsetting daytime grid consumption.</p>
<p>The intraday demand profile in <a href="#fig-seasonal-intraday" class="quarto-xref">Figure&nbsp;4</a> (right) further illustrates this evolution: as PV uptake has expanded, midday demand has progressively decreased, deepening the characteristic “duck curve.” However, during winter—when solar output and daylight hours are minimal—PV contributes little to offsetting load. This seasonal imbalance in solar influence results in a persistent winter sensitivity.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-seasonal-intraday" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-seasonal-intraday-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-seasonal-intraday-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seasonal-intraday-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Monthly and Intraday Electricity Demand Patterns in Victoria: Left — Monthly average demand aligned by AEMO season year (Apr–Mar); Right — Duck curve evolution by financial year with PV capacity labels.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Electricity demand in Victoria also shows a clear and evolving sensitivity to temperature and solar exposure, as illustrated in <a href="#fig-tmax-demand" class="quarto-xref">Figure&nbsp;5</a> and <a href="#fig-tmin-demand" class="quarto-xref">Figure&nbsp;6</a>. The relationship between temperature and demand forms a distinct U-shaped curve, with demand rising sharply under both cold and hot extremes. The steepening of this curve over time highlights intensifying heating and cooling sensitivities — reflecting evolving behaviour, appliance penetration, and PV adoption that reshape daily load profiles.</p>
<p>Seasonally, these relationships vary substantially:</p>
<ul>
<li><p>Winter: Demand declines nearly linearly with temperature, as heating load dominates and warmer days reduce electricity use.</p></li>
<li><p>Summer: Demand rises with temperature but is moderated by PV generation, which offsets midday consumption.</p></li>
<li><p>Spring and Autumn: Transitional patterns show nonlinear responses, reflecting mixed heating and cooling effects.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-tmax-demand" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tmax-demand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-tmax-demand-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tmax-demand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Tmax–Demand relationships by financial year and by season.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-tmin-demand" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tmin-demand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-tmin-demand-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tmin-demand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Tmin–Demand relationships by financial year and by season.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Solar exposure further introduces a moderating, time-dependent effect: high solar days now correspond to lower grid demand, particularly after 2019, when distributed PV generation became widespread. This inverse association is most evident in winter and the shoulder seasons, where low solar exposure (cloudy days) coincides with elevated demand.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-solar-demand" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-solar-demand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-solar-demand-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-solar-demand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Solar–Demand relationships by financial year and by season.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Collectively, these findings demonstrate that Victorian electricity demand has become more weather-dependent, nonlinear, and seasonally complex. Temperature remains the dominant driver, while solar exposure introduces critical interactions that vary across seasons and times of day. These dynamics justify the use of data-driven, seasonally adaptive modelling frameworks, such as local-season clustering and nonlinear GAMM structures introduced in <a href="#sec-model-comparison" class="quarto-xref">Section&nbsp;6.1</a>, to capture evolving winter variability and temperature–solar interactions shaping Victoria’s electricity demand.</p>
</section>
<section id="local-season-clustering-via-gmm" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="local-season-clustering-via-gmm"><span class="header-section-number">4.5</span> Local Season Clustering via GMM</h2>
<p>Building on the patterns observed in <a href="#fig-seasonal-intraday" class="quarto-xref">Figure&nbsp;4</a>, where energy behaviours do not always align with traditional calendar seasons, we move beyond rigid calendar-based definitions of seasons by applying a Gaussian Mixture Model (GMM). The rationale is that the same temperature can elicit very different consumption responses depending on the season and perceived comfort level — for instance, 20 °C may be considered cool and heating-driven in summer but mild and comfortable in winter. By clustering days based on prevailing temperature and solar exposure patterns, the GMM identifies data-driven “local seasons” that better reflect the true meteorological and behavioural regimes influencing electricity demand</p>
<p>The clustering was performed using the daily PCA-composite weather features — tmax_pca, tmin_pca, and solar_pca — as the input variables. Before clustering, all features were standardized (mean = 0, sd = 1) to ensure equal weighting. Conceptually, the GMM assumes that these feature vectors come from a mixture of multivariate normal distributions, each representing a distinct weather regime. Each component is characterized by a mean vector (cluster centroid) and a covariance matrix (spread and orientation).</p>
<p>We used the <code>mclust</code> package in R, which automatically fits multiple candidate GMMs and selects the optimal number of clusters based on the Bayesian Information Criterion (BIC). Models with between 3 and 6 clusters were tested; the BIC indicated that a six-cluster solution achieved a good balance between parsimony and meteorological interpretability. The Gaussian Mixture Model (GMM) is applied as an intermediate feature-engineering step to identify data-driven weather regimes—referred to as local seasons. Unlike predictive models, GMM is not trained or tested for performance; instead, it is fitted once on the entire 2019–2025 weather dataset to capture the full range of climatic patterns. Using the PCA-combined weather features (Tmax, Tmin, and Solar), the GMM clusters days with similar weather conditions, allowing for soft probabilistic membership across transitional periods.</p>
<p>The month–cluster composition in <a href="#fig-gmm-month" class="quarto-xref">Figure&nbsp;8</a>, together with the summary statistics in <a href="#tbl-local-season-summary" class="quarto-xref">Table&nbsp;4</a>, demonstrates that the six GMM-defined local seasons effectively capture Victoria’s meteorological cycle with clear seasonal realism. Hot &amp; Very Sunny and Warm &amp; Bright clusters dominate from December to February, representing the hot, high-solar summer period. In contrast, Cold &amp; Cloudy and Cold &amp; Clear prevail from June to August, reflecting distinct winter regimes—the former associated with overcast, moisture-laden conditions, and the latter with clear, radiatively cold nights. Transitional regimes— Mild &amp; Cloudy and Mild &amp; Sunny—occur mainly in autumn (March–May) and spring (September–November), respectively, depicting smooth shifts between heating- and cooling-dominated periods across Victoria’s seasonal cycle.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gmm-month" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gmm-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-gmm-month-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gmm-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Month × Cluster shares
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-local-season-summary" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-local-season-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="fdjowbgria" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fdjowbgria table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fdjowbgria thead, #fdjowbgria tbody, #fdjowbgria tfoot, #fdjowbgria tr, #fdjowbgria td, #fdjowbgria th {
  border-style: none;
}

#fdjowbgria p {
  margin: 0;
  padding: 0;
}

#fdjowbgria .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fdjowbgria .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fdjowbgria .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fdjowbgria .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fdjowbgria .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fdjowbgria .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fdjowbgria .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fdjowbgria .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fdjowbgria .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fdjowbgria .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fdjowbgria .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fdjowbgria .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fdjowbgria .gt_spanner_row {
  border-bottom-style: hidden;
}

#fdjowbgria .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fdjowbgria .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fdjowbgria .gt_from_md > :first-child {
  margin-top: 0;
}

#fdjowbgria .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fdjowbgria .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fdjowbgria .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fdjowbgria .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fdjowbgria .gt_row_group_first td {
  border-top-width: 2px;
}

#fdjowbgria .gt_row_group_first th {
  border-top-width: 2px;
}

#fdjowbgria .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fdjowbgria .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fdjowbgria .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fdjowbgria .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fdjowbgria .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fdjowbgria .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fdjowbgria .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fdjowbgria .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fdjowbgria .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fdjowbgria .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fdjowbgria .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fdjowbgria .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fdjowbgria .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fdjowbgria .gt_left {
  text-align: left;
}

#fdjowbgria .gt_center {
  text-align: center;
}

#fdjowbgria .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fdjowbgria .gt_font_normal {
  font-weight: normal;
}

#fdjowbgria .gt_font_bold {
  font-weight: bold;
}

#fdjowbgria .gt_font_italic {
  font-style: italic;
}

#fdjowbgria .gt_super {
  font-size: 65%;
}

#fdjowbgria .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fdjowbgria .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fdjowbgria .gt_indent_1 {
  text-indent: 5px;
}

#fdjowbgria .gt_indent_2 {
  text-indent: 10px;
}

#fdjowbgria .gt_indent_3 {
  text-indent: 15px;
}

#fdjowbgria .gt_indent_4 {
  text-indent: 20px;
}

#fdjowbgria .gt_indent_5 {
  text-indent: 25px;
}

#fdjowbgria .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fdjowbgria div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border">Local Season Cluster Characteristics (GMM, Victoria)</th>
</tr>
<tr class="odd gt_col_headings">
<th id="Cluster" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">Cluster</th>
<th id="Mean-Tmax-(°C)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">Mean Tmax (°C)</th>
<th id="Mean-Tmin-(°C)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">Mean Tmin (°C)</th>
<th id="Mean-Solar-(MJ/m²)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">Mean Solar (MJ/m²)</th>
<th id="Key-Features" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">Key Features</th>
<th id="Suggested-Label" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">Suggested Label</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="Cluster">1</td>
<td class="gt_row gt_center" headers="Mean Tmax (°C)">13.51</td>
<td class="gt_row gt_center" headers="Mean Tmin (°C)">2.95</td>
<td class="gt_row gt_center" headers="Mean Solar (MJ/m²)">8.78</td>
<td class="gt_row gt_center" headers="Key Features">Very cold days with clear skies — classic deep winter conditions</td>
<td class="gt_row gt_center" headers="Suggested Label">Cold &amp; Clear (Winter Peak)</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Cluster">2</td>
<td class="gt_row gt_center" headers="Mean Tmax (°C)">16.81</td>
<td class="gt_row gt_center" headers="Mean Tmin (°C)">7.29</td>
<td class="gt_row gt_center" headers="Mean Solar (MJ/m²)">10.99</td>
<td class="gt_row gt_center" headers="Key Features">Cool and mild with moderate sunlight — early spring</td>
<td class="gt_row gt_center" headers="Suggested Label">Mild &amp; Sunny (Early Spring)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Cluster">3</td>
<td class="gt_row gt_center" headers="Mean Tmax (°C)">13.14</td>
<td class="gt_row gt_center" headers="Mean Tmin (°C)">6.94</td>
<td class="gt_row gt_center" headers="Mean Solar (MJ/m²)">6.79</td>
<td class="gt_row gt_center" headers="Key Features">Cold, cloudy, low solar — overcast winter pattern</td>
<td class="gt_row gt_center" headers="Suggested Label">Cold &amp; Cloudy (Winter Typical)</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Cluster">4</td>
<td class="gt_row gt_center" headers="Mean Tmax (°C)">26.17</td>
<td class="gt_row gt_center" headers="Mean Tmin (°C)">10.90</td>
<td class="gt_row gt_center" headers="Mean Solar (MJ/m²)">18.51</td>
<td class="gt_row gt_center" headers="Key Features">Warm and bright — late spring to early summer</td>
<td class="gt_row gt_center" headers="Suggested Label">Warm &amp; Bright (Late Spring)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Cluster">5</td>
<td class="gt_row gt_center" headers="Mean Tmax (°C)">27.10</td>
<td class="gt_row gt_center" headers="Mean Tmin (°C)">12.50</td>
<td class="gt_row gt_center" headers="Mean Solar (MJ/m²)">28.10</td>
<td class="gt_row gt_center" headers="Key Features">Hot and extremely sunny — midsummer conditions</td>
<td class="gt_row gt_center" headers="Suggested Label">Hot &amp; Very Sunny (Summer Peak)</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Cluster">6</td>
<td class="gt_row gt_center" headers="Mean Tmax (°C)">19.96</td>
<td class="gt_row gt_center" headers="Mean Tmin (°C)">12.06</td>
<td class="gt_row gt_center" headers="Mean Solar (MJ/m²)">16.66</td>
<td class="gt_row gt_center" headers="Key Features">Mild warm nights and moderate sunlight — autumn pattern</td>
<td class="gt_row gt_center" headers="Suggested Label">Mild &amp; Cloudy (Autumn Typical)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-local-season-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Local Season Cluster Characteristics (Final Labels and Interpretations)
</figcaption>
</figure>
</div>
</div>
<p>This data-driven classification aligns broadly with conventional seasonal boundaries but provides greater granularity and flexibility, distinguishing between meteorologically meaningful sub-seasons that fixed calendar groupings cannot represent. The resulting local season labels thus form a robust categorical structure for regime-aware demand modeling, enabling temperature–demand relationships to adapt to actual weather regimes rather than arbitrary months.</p>
</section>
<section id="feature-engineering-summary" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="feature-engineering-summary"><span class="header-section-number">4.6</span> Feature Engineering Summary</h2>
<p>The feature-engineering process transformed raw weather, calendar, and demand data into a structured set of interpretable predictors that capture both short-term behavioral responses and long-term structural trends in Victoria’s electricity system. Each feature was motivated by EDA evidence and designed to align with real-world drivers of demand variability—ranging from temperature extremes and PV offset to seasonal clustering and autocorrelation effects.</p>
<p>As summarized in <a href="#tbl-feature-engineering" class="quarto-xref">Table&nbsp;5</a>, the final feature set integrates six major categories: temporal controls, unified PCA weather signals, derived thermal indicators, autoregressive persistence, long-term cyclic trends, and regime-based seasonal factors.</p>
<div class="cell">
<div id="tbl-feature-engineering" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-feature-engineering-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<table class="table do-not-create-environment cell table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Category</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable(s)</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Description / Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Temporal Features</td>
<td style="text-align: left;">`date`, `doy`, `dow`, `year`, `month`, `season`, `is_holiday`</td>
<td style="text-align: left;">Calendar-based controls for daily, weekly, and seasonal effects. `doy` (day-of-year) captures the annual cycle; `dow` (day-of-week) captures weekly load patterns; `is_holiday` flags public holidays and special events.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Temperature &amp; Solar PCA</td>
<td style="text-align: left;">`tmax_pca`, `tmin_pca`, `solar_pca`</td>
<td style="text-align: left;">First two principal components (PC1 + PC2) of Tmax, Tmin, and solar exposure across multiple weather stations — removes multicollinearity and summarizes regional weather signals.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Derived Thermal Indicators</td>
<td style="text-align: left;">`Tmean_pca`, `Trange_pca`, `HDD`, `CDD`</td>
<td style="text-align: left;">`Tmean_pca` and `Trange_pca` represent mean and diurnal variability of daily temperature; `HDD` = max(0, 16.5 − Tmean_pca) and `CDD` = max(0, Tmean_pca − 18) follow AEMO VIC definitions, capturing heating and cooling intensity.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Autoregressive Features</td>
<td style="text-align: left;">`demand_lag1`, `demand_lag7`</td>
<td style="text-align: left;">Lagged demand terms capturing persistence effects: `demand_lag1` models previous-day correlation; `demand_lag7` captures weekly cyclic dependence.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Time Trend &amp; Cyclic Terms</td>
<td style="text-align: left;">`t`, `sin_t = sin(2πt / 365.25)`, `cos_t = cos(2πt / 365.25)`, `t_sin = t × sin_t`, `t_cos = t × cos_t`</td>
<td style="text-align: left;">Continuous time index and its Fourier seasonal harmonics representing long-term structural trend and evolving intra-year periodicity (365.25-day cycle).</td>
</tr>
<tr class="even">
<td style="text-align: left;">Local Season Regime</td>
<td style="text-align: left;">`local_season`</td>
<td style="text-align: left;">Categorical feature from Gaussian Mixture Model (GMM) clustering of PCA weather variables (Tmax, Tmin, Solar). Represents data-driven ‘local seasons’ (e.g., Hot &amp; Sunny, Cold &amp; Cloudy, Mild &amp; Bright) for regime-aware modeling.</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-feature-engineering-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Summary of engineered features informed by EDA.
</figcaption>
</figure>
</div>
</div>
<p>Together, these engineered features provide a robust foundation for the subsequent GAM and GAMM modeling, enabling the models to capture nonlinear, time-varying, and regime-dependent demand responses.</p>
<p>In summary, the exploratory data analysis (EDA) reinforced several key modeling decisions:</p>
<ul>
<li><p>the necessity of incorporating nonlinear temperature and solar terms;</p></li>
<li><p>the value of differentiating weather responses by season or regime, and accounting for calendar, trend, and autocorrelation effects; and</p></li>
<li><p>the growing influence of distributed PV uptake, suggesting that a unified model can effectively capture post-2019 dynamics when designed with appropriate weather, temporal, and regime-based features.</p></li>
</ul>
</section>
</section>
<section id="sec-Methodology" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Methodology</h1>
<p>Building on the engineered feature set, this section outlines the modeling framework used to quantify the drivers of electricity demand in Victoria. The approach centers on Generalized Additive Models (GAMs) and Generalized Additive Mixed Models (GAMMs), which flexibly capture nonlinear, time-varying, and regime-dependent effects. These models are particularly suited to the complex structure of electricity demand data, where temperature, solar exposure, and behavioral patterns interact in nonlinear ways.</p>
<p>We begin by describing the general GAM formulation, its smoothing structure, and the rationale for using nonlinear smooths over key predictors such as temperature and solar exposure. The subsequent section extends this to a mixed-effects GAMM, incorporating autocorrelation structures and local-season effects to address temporal dependence and weather-regime variation. Together, these methods provide a transparent and interpretable framework for modeling Victoria’s demand dynamics from 2019–2025.</p>
<section id="model-specification" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="model-specification"><span class="header-section-number">5.1</span> Model Specification</h2>
<p>The Generalized Additive Model (GAM) can be expressed as:</p>
<p><span class="math display">\[
y_t = \beta_0 + \sum_j f_j(x_{j,t}) + \varepsilon_t, \quad \varepsilon_t \sim N(0, \sigma^2)
\]</span></p>
<p>where each smooth function <code>f_j()</code> captures a nonlinear effect of predictor <code>x_{j,t}</code> on the response <code>y_t</code> .</p>
<p>However, the standard GAM assumes that residuals are independent and homoskedastic, which may not hold in time-series or grouped data such as electricity demand.</p>
<p>To address this limitation, the model can be extended to a Generalized Additive Mixed Model (GAMM), which incorporates random effects and structured residual variance:</p>
<p><span class="math display">\[
y_t = \beta_0 + \sum_j f_j(x_{j,t}) + Zb + \varepsilon_t, \quad b \sim N(0, \Psi), \ \varepsilon_t \sim N(0, \Sigma)
\]</span></p>
<p>Here, <code>b</code> represents random effects capturing within-group dependence (e.g., local weather regimes), while the residual variance structure <code>Sigma</code> allows for heteroskedasticity across groups.<br>
This formulation enables the model to capture both nonlinear predictor effects and correlated or uneven residual variability.</p>
<p>The final model is specified as: Dₜ = t + tsinₜ + tcosₜ + Season + s(Tₓ, Season) + s(Tᵧ, Season) + s(Solar, Season) + ti(Tₓ, Solar) + ti(Tᵧ, Solar) + s(doy) + dow + is_holiday + Dₜ₋₁ + Dₜ₋₇</p>
<p>where Dₜ is daily electricity demand (MWh); Tₓ and Tᵧ denote temperature-related variables (e.g., Tmean, Trange, HDD, CDD); the smooth functions <code>s()</code> and tensor-product interactions <code>ti()</code> represent smooth and tensor interaction terms capturing nonlinear and interaction effects across seasons; and Dₜ₋₁ and Dₜ₋₇ are autoregressive lags accounting for short-term persistence and weekly patterns.</p>
<p>This specification was implemented using the mgcv package <span class="citation" data-cites="Wood2017">(<a href="#ref-Wood2017" role="doc-biblioref">Wood 2017</a>)</span> in R 4.5.1, leveraging <code>bam()</code> / <code>gamm()</code> for efficient estimation with correlated residual structures. <a href="#tbl-model-grid" class="quarto-xref">Table&nbsp;6</a> summarize the model variants.</p>
<div class="cell">
<div id="tbl-model-grid" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-model-grid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<table class="table do-not-create-environment cell table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Season</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">T_x, T_y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Month</td>
<td style="text-align: left;">Tmin, Tmax</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Month</td>
<td style="text-align: left;">Tmean, Trange</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Month</td>
<td style="text-align: left;">HDD, CDD</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Traditional Season</td>
<td style="text-align: left;">Tmin, Tmax</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">Traditional Season</td>
<td style="text-align: left;">Tmean, Trange</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">Traditional Season</td>
<td style="text-align: left;">HDD, CDD</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">Local Season</td>
<td style="text-align: left;">Tmin, Tmax</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">Local Season</td>
<td style="text-align: left;">Tmean, Trange</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">Local Season</td>
<td style="text-align: left;">HDD, CDD</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-model-grid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Candidate model grid combining season grouping and temperature
</figcaption>
</figure>
</div>
</div>
</section>
<section id="model-training-and-validation" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="model-training-and-validation"><span class="header-section-number">5.2</span> Model Training and Validation</h2>
<p>The modeling process employed a Generalized Additive Mixed Model (GAMM) framework trained on data from 1 July 2019 to 30 June 2024, with REML used to select optimal smoothing parameters.</p>
<p>The training workflow followed standard best practices:</p>
<ul>
<li><p>Data split — training on 2019-07-01 to 2024-06-30, validation on 2024-07-01 to 2025-06-30.</p></li>
<li><p>Automatic smoothness selection — ensuring balance between flexibility and generalization.</p></li>
<li><p>Residual and diagnostic checks — confirming no systematic bias or autocorrelation.</p></li>
</ul>
<p>Model performance was evaluated using three key metrics: Root Mean Square Error (RMSE), Mean Absolute Percentage Error (MAPE), and the Coefficient of Determination (R²) — alongside the Ljung–Box test for residual independence.</p>
<ul>
<li><p>RMSE measures the square root of the average squared deviation between predicted and actual demand, providing a indicator of overall forecast accuracy while penalizing larger errors more heavily.</p></li>
<li><p>MAPE expresses the mean absolute deviation as a percentage of observed demand, enabling intuitive interpretation of forecast precision across different demand levels (e.g., a MAPE of 3% indicates that forecasts are typically within 3% of actual demand).</p></li>
<li><p>R² quantifies the proportion of variability in actual demand explained by the model, with higher values signifying stronger predictive and explanatory capability.</p></li>
<li><p>Ljung–Box test assesses whether residuals exhibit significant autocorrelation at specified lags. A non-significant result (p &gt; 0.05) suggests that the residuals behave as white noise, indicating that the model has adequately captured temporal dependence in the data.</p></li>
</ul>
<p>Together, these metrics offer a clear and balanced assessment of model performance, reflecting both the accuracy of the forecasts and the model’s ability to capture underlying weather–demand relationships</p>
</section>
</section>
<section id="sec-results" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Results</h1>
<p>In this section, we present the key results of the forecasting model, focusing on how well it performed and what insights can be drawn. Both quantitative accuracy metrics and qualitative consistency with domain expectations are examined to evaluate model reliability and interpretability.</p>
<section id="sec-model-comparison" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="sec-model-comparison"><span class="header-section-number">6.1</span> Comparison with different verions</h2>
<p>To systematically evaluate model performance, the workflow runs the full modeling pipeline — fitting each GAM formulation, evaluating training and testing metrics (R², RMSE, MAPE), checking residuals (Ljung–Box test) and comparing across the nine configurations that combine seasonal grouping and temperature construction.</p>
<p>As illustrated in <a href="#tbl-model-performance" class="quarto-xref">Table&nbsp;7</a>, the Local Season formulation offers the best trade-off between predictive accuracy and statistical adequacy, supporting its adoption for subsequent model refinement and forecasting.</p>
<div class="cell">
<div id="tbl-model-performance" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-model-performance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<table class="table do-not-create-environment cell table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">R²</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">RMSE</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">MAPE (%)</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">LB14 Pass?</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">LB28 Pass?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; color: rgba(102, 102, 102, 255) !important;">01 Month — Tmin/Tmax</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">0.934</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">4828.838</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">3.176</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">No</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left; color: rgba(102, 102, 102, 255) !important;">02 Month — Tmean/Trange</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">0.926</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">5108.549</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">3.431</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">No</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: rgba(102, 102, 102, 255) !important;">03 Month — HDD/CDD</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">0.933</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">4860.641</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">3.265</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">No</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">No</td>
</tr>
<tr class="even">
<td style="text-align: left; color: rgba(102, 102, 102, 255) !important;">04 Traditional Season — Tmin/Tmax</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">0.936</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">4751.423</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">3.203</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">No</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: rgba(102, 102, 102, 255) !important;">05 Traditional Season — Tmean/Trange</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">0.933</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">4844.583</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">3.239</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">No</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">No</td>
</tr>
<tr class="even">
<td style="text-align: left; color: rgba(102, 102, 102, 255) !important;">06 Traditional Season — HDD/CDD</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">0.932</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">4885.123</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">3.356</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">No</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; background-color: rgba(224, 242, 241, 255) !important;">07 Local Season — Tmin/Tmax</td>
<td style="text-align: center; font-weight: bold; background-color: rgba(224, 242, 241, 255) !important;">0.932</td>
<td style="text-align: center; font-weight: bold; background-color: rgba(224, 242, 241, 255) !important;">4883.929</td>
<td style="text-align: center; font-weight: bold; background-color: rgba(224, 242, 241, 255) !important;">3.288</td>
<td style="text-align: center; font-weight: bold; background-color: rgba(224, 242, 241, 255) !important;">Yes</td>
<td style="text-align: center; font-weight: bold; background-color: rgba(224, 242, 241, 255) !important;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; background-color: rgba(224, 242, 241, 255) !important;">08 Local Season — Tmean/Trange</td>
<td style="text-align: center; font-weight: bold; background-color: rgba(224, 242, 241, 255) !important;">0.933</td>
<td style="text-align: center; font-weight: bold; background-color: rgba(224, 242, 241, 255) !important;">4865.390</td>
<td style="text-align: center; font-weight: bold; background-color: rgba(224, 242, 241, 255) !important;">3.294</td>
<td style="text-align: center; font-weight: bold; background-color: rgba(224, 242, 241, 255) !important;">Yes</td>
<td style="text-align: center; font-weight: bold; background-color: rgba(224, 242, 241, 255) !important;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: rgba(102, 102, 102, 255) !important;">09 Local Season — HDD/CDD</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">0.933</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">4842.428</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">3.341</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">No</td>
<td style="text-align: center; color: rgba(102, 102, 102, 255) !important;">Yes</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-model-performance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Model Performance (TEST) — with Ljung–Box Pass/Fail Summary
</figcaption>
</figure>
</div>
</div>
</section>
<section id="model-evaluation-best-performing-model-tmean_pcatrange_pca-with-local-season" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="model-evaluation-best-performing-model-tmean_pcatrange_pca-with-local-season"><span class="header-section-number">6.2</span> Model Evaluation — Best Performing Model (Tmean_pca/Trange_pca with Local Season)</h2>
<p>To assess the adequacy of the best-performing model (local-season GAM with Tmean_pca and Trange_pca), we examined residual diagnostics to verify model assumptions and check for remaining bias, heteroskedasticity, or autocorrelation.</p>
<p><a href="#fig-gam-check" class="quarto-xref">Figure&nbsp;9</a> shows the standard diagnostic plots from <code>gam.check()</code>. The residuals are approximately normally distributed with no significant skew or pattern, and the fitted values align closely with observed demand, indicating a strong model fit.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gam-check" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gam-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-gam-check-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gam-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Model diagnostics for the best GAM (local-season with Tmean_pca/Trange_pca): QQ plot, residual distribution, and fitted vs observed demand.
</figcaption>
</figure>
</div>
</div>
</div>
<p>However, as shown in <a href="#fig-resid-by-season" class="quarto-xref">Figure&nbsp;10</a>, a slight winter bias remains—residuals during cold and cloudy regimes tend to underestimate demand. This pattern suggests that the model struggles to fully capture winter conditions, when solar generation is minimal and heating demand increases sharply. It also exhibits the greatest interannual variability in recent years, reflecting changing weather and behavioural dynamics. Nonetheless, residuals remain centered around zero across other seasons, confirming that the local-season framework effectively mitigates most seasonal heterogeneity.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-resid-by-season" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resid-by-season-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-resid-by-season-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resid-by-season-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Residual distribution by day-of-year (DOY) and local season for the best GAM model (Tmean_pca / Trange_pca). Each facet shows deviations between predicted and observed demand by weather regime, with a slight winter underfit visible.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Overall, the diagnostics support that the chosen GAM structure is statistically adequate, with independent residuals, limited heteroskedasticity, and physically interpretable behavior across weather regimes.</p>
</section>
<section id="sec-gamm-heteroskedasticity" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="sec-gamm-heteroskedasticity"><span class="header-section-number">6.3</span> Extending to GAMM: Addressing Heteroskedasticity</h2>
<p>To address heteroskedasticity, we introduce a Generalized Additive Mixed Model (GAMM) with a group-specific variance structure: <code>varIdent(~1 | local_season)</code>.</p>
<p>Incorporating a heteroskedastic variance structure stabilizes residuals across seasonal regimes, with variance highest under Cold &amp; Clear and lowest under Mild &amp; Moderate conditions (see @ tbl-variance).This allows residual variance to differ by local season, explicitly modeling heteroskedasticity rather than ignoring it. The approach yields more reliable standard errors and smoother residual behavior across conditions, particularly during extreme weather events.</p>
<div class="cell">
<div id="tbl-variance" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-variance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Local_Season</th>
<th style="text-align: center;">Variance_Multiplier</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cold &amp; Clear</td>
<td style="text-align: center;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cold &amp; Cloudy</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hot &amp; Very Sunny</td>
<td style="text-align: center;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mild &amp; Cloudy</td>
<td style="text-align: center;">0.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mild &amp; Sunny</td>
<td style="text-align: center;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">Warm &amp; Bright</td>
<td style="text-align: center;">0.22</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-variance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: Residual variance multipliers by local season (varIdent weights)
</figcaption>
</figure>
</div>
</div>
<p><a href="#fig-gamm-stdresid" class="quarto-xref">Figure&nbsp;11</a> confirms that the <code>varIdent(~1 | local_season)</code> specification effectively stabilizes residual variance while preserving model interpretability and out-of-sample performance.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gamm-stdresid" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gamm-stdresid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-gamm-stdresid-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gamm-stdresid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Standardized residual diagnostics for the variance-weighted GAMM. After applying varIdent(~1 | local_season), residual spread is more uniform across regimes.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Then let’s check the overall performance of GAMM model. As shown in <a href="#fig-gamm-forecast" class="quarto-xref">Figure&nbsp;12</a>, the variance-weighted GAMM maintains good fit (R² ≈ 0.94) and high predictive accuracy ( MAPE ≈ 3.28 %). the model exhibits slight underfitting during mid-winter periods—likely due to behavioural or heating-related nonlinearities not fully captured—and occasionally misses short-lived extreme demand spikes.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gamm-forecast" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gamm-forecast-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-gamm-forecast-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gamm-forecast-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Out-of-sample performance of the variance-weighted GAMM (2024–2025 test set). Forecasts align closely with observed demand, confirming robust generalization.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Nevertheless, residual diagnostics indicate no major departures from model assumptions: standardized residuals show no discernible structure and approximate homoskedastic, zero-mean behaviour (<a href="#fig-gamm-stdresid" class="quarto-xref">Figure&nbsp;11</a>), and formal checks including QQ, ACF, and response-vs-fitted plots reveal no significant distributional or independence violations (<a href="#fig-gamm-check" class="quarto-xref">Figure&nbsp;13</a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gamm-check" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gamm-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-gamm-check-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gamm-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: GAMM diagnostic plots generated via <code>gratia::appraise()</code>. The QQ-plot, residuals, and response–fitted checks confirm approximate normality and homoscedasticity.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Then, multi-horizon forecast accuracy was assessed using a recursive forecasting approach, in which the training window (2019–2024) was kept fixed while forecasts were generated sequentially over the 2024–2025 period. The variance-weighted GAMM exhibited consistently strong performance across multiple forecast horizons.</p>
<p>Short-term forecasts were highly reliable, achieving R² = 0.78–0.93 and MAPE = 1.68–2.58% for 3–14-day horizons. Even at the 30-day horizon, performance remained robust (R² = 0.87, MAPE = 2.51%), while the year-ahead forecast retained high explanatory power (R² = 0.94) with only moderate error (MAPE = 3.28%). Overall, forecast accuracy declined with increasing horizon length, though not always consistently across all periods. This irregularity likely reflects the limited validation window, which constrains the robustness of longer-horizon evaluation. Nevertheless, as summarized in <a href="#tbl-horizon-results" class="quarto-xref">Table&nbsp;9</a>, the model demonstrates strong reliability for short- to medium-term operational forecasting within approximately a one-year horizon.</p>
<div class="cell">
<div id="tbl-horizon-results" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-horizon-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Horizon</th>
<th style="text-align: left;">R2</th>
<th style="text-align: right;">RMSE</th>
<th style="text-align: right;">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">3-day</td>
<td style="text-align: left;">0.776</td>
<td style="text-align: right;">2605.0</td>
<td style="text-align: right;">1.68</td>
</tr>
<tr class="even">
<td style="text-align: left;">7-day</td>
<td style="text-align: left;">0.932</td>
<td style="text-align: right;">4430.8</td>
<td style="text-align: right;">2.59</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14-day</td>
<td style="text-align: left;">0.932</td>
<td style="text-align: right;">3572.6</td>
<td style="text-align: right;">1.96</td>
</tr>
<tr class="even">
<td style="text-align: left;">30-day</td>
<td style="text-align: left;">0.868</td>
<td style="text-align: right;">4609.8</td>
<td style="text-align: right;">2.51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">365-day</td>
<td style="text-align: left;">0.939</td>
<td style="text-align: right;">4843.0</td>
<td style="text-align: right;">3.28</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-horizon-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: Recursive h-step forecast accuracy across horizons.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="out-of-sample-forecasts" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="out-of-sample-forecasts"><span class="header-section-number">6.4</span> Out-of-sample forecasts</h2>
<p>To evaluate short-term generalization beyond the training period, the variance-weighted GAMM was applied to forecast daily electricity demand for July 2025. As shown in <a href="#fig-gamm-forecast-2025" class="quarto-xref">Figure&nbsp;14</a>, the model continued to track observed demand closely beyond the training horizon, with forecast errors remaining low (RMSE ≈ 5.5 GWh, MAPE ≈ 3.14%)—slightly higher than the in-sample one-month-ahead accuracy, as expected.</p>
<p>These results indicate that the model generalizes well under new weather conditions, effectively capturing overall demand dynamics and weekly variation patterns. Minor underprediction during colder winter days suggests residual sensitivity to extreme low-temperature events, but overall the GAMM framework demonstrates strong robustness for short-term operational forecasting.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gamm-forecast-2025" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gamm-forecast-2025-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="picture/final_panel.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gamm-forecast-2025-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: GAMM forecasts versus actual electricity demand (2025-07-01 to 2025-08-05). The dashed red line represents predicted values.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-Interpretation-of-Model-Components" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="sec-Interpretation-of-Model-Components"><span class="header-section-number">6.5</span> Interpretation of Model Components</h2>
<p>Overall, the fitted GAMM effectively decomposes Victoria’s electricity demand into interpretable and physically consistent components. Temperature remains the dominant driver, exhibiting a clear asymmetry between heating- and cooling-related regimes ( <a href="#fig-gamm-all-1" class="quarto-xref">Figure&nbsp;15</a>). Solar exposure exerts a consistently negative effect on demand ( <a href="#fig-gamm-all-3" class="quarto-xref">Figure&nbsp;17</a>), reflecting the increasing influence of rooftop PV generation in reducing daytime grid load. The diurnal temperature range and solar–temperature interaction terms indicate that clear-sky conditions substantially moderate demand ( <a href="#fig-gamm-all-2" class="quarto-xref">Figure&nbsp;16</a>), while the cyclic calendar smooth captures the expected winter and summer peaks ( <a href="#fig-gamm-all-4" class="quarto-xref">Figure&nbsp;18</a>).</p>
<p>A concise summary of significant model components and their implications is presented in <a href="#tbl-gamm-grouped-interpretation" class="quarto-xref">Table&nbsp;10</a>, while the full list of model terms and significance results is provided in Appendix A (<a href="#tbl-gamm-terms" class="quarto-xref">Table&nbsp;11</a>). Collectively, these results demonstrate that the GAMM captures realistic, weather-dependent, and behavioral load dynamics with strong alignment to domain knowledge. For completeness, all smooth components are displayed in Appendix B ( <a href="#fig-gamm-all-1" class="quarto-xref">Figure&nbsp;15</a> to <a href="#fig-gamm-all-4" class="quarto-xref">Figure&nbsp;18</a>).</p>
<div class="cell">
<div id="tbl-gamm-grouped-interpretation" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-gamm-grouped-interpretation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="bicrkrohwg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bicrkrohwg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bicrkrohwg thead, #bicrkrohwg tbody, #bicrkrohwg tfoot, #bicrkrohwg tr, #bicrkrohwg td, #bicrkrohwg th {
  border-style: none;
}

#bicrkrohwg p {
  margin: 0;
  padding: 0;
}

#bicrkrohwg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bicrkrohwg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bicrkrohwg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bicrkrohwg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bicrkrohwg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bicrkrohwg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bicrkrohwg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bicrkrohwg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bicrkrohwg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bicrkrohwg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bicrkrohwg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bicrkrohwg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bicrkrohwg .gt_spanner_row {
  border-bottom-style: hidden;
}

#bicrkrohwg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #F2F6FC;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bicrkrohwg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #F2F6FC;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bicrkrohwg .gt_from_md > :first-child {
  margin-top: 0;
}

#bicrkrohwg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bicrkrohwg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bicrkrohwg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bicrkrohwg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bicrkrohwg .gt_row_group_first td {
  border-top-width: 2px;
}

#bicrkrohwg .gt_row_group_first th {
  border-top-width: 2px;
}

#bicrkrohwg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bicrkrohwg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bicrkrohwg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bicrkrohwg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bicrkrohwg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bicrkrohwg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bicrkrohwg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bicrkrohwg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bicrkrohwg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bicrkrohwg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bicrkrohwg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bicrkrohwg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bicrkrohwg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bicrkrohwg .gt_left {
  text-align: left;
}

#bicrkrohwg .gt_center {
  text-align: center;
}

#bicrkrohwg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bicrkrohwg .gt_font_normal {
  font-weight: normal;
}

#bicrkrohwg .gt_font_bold {
  font-weight: bold;
}

#bicrkrohwg .gt_font_italic {
  font-style: italic;
}

#bicrkrohwg .gt_super {
  font-size: 65%;
}

#bicrkrohwg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bicrkrohwg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bicrkrohwg .gt_indent_1 {
  text-indent: 5px;
}

#bicrkrohwg .gt_indent_2 {
  text-indent: 10px;
}

#bicrkrohwg .gt_indent_3 {
  text-indent: 15px;
}

#bicrkrohwg .gt_indent_4 {
  text-indent: 20px;
}

#bicrkrohwg .gt_indent_5 {
  text-indent: 25px;
}

#bicrkrohwg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bicrkrohwg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="4" class="gt_heading gt_title gt_font_normal"><strong>Grouped Interpretation of GAMM Smooth Terms</strong></th>
</tr>
<tr class="odd gt_heading">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Summarising nonlinear effects of temperature, diurnal range, solar exposure, and seasonal patterns</th>
</tr>
<tr class="header gt_col_headings">
<th id="Variable_Season" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Variable / Season</th>
<th id="Shape" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Shape</th>
<th id="Interpretation" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Interpretation</th>
<th id="Takeaway" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Key Takeaway</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="4" id="Temperature" class="gt_group_heading" data-quarto-table-cell-role="th" style="color: #00008B; font-weight: bold" scope="colgroup">Temperature</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="Temperature  Variable_Season">Cold &amp; Clear / Cold &amp; Cloudy</td>
<td class="gt_row gt_left" headers="Temperature  Shape">Strong negative slope</td>
<td class="gt_row gt_left" headers="Temperature  Interpretation">Demand decreases sharply as temperature rises → heating-dominated response.</td>
<td class="gt_row gt_left" headers="Temperature  Takeaway">Heating dominates in cold regimes.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Temperature  Variable_Season">Hot &amp; Very Sunny</td>
<td class="gt_row gt_left" headers="Temperature  Shape">Positive slope</td>
<td class="gt_row gt_left" headers="Temperature  Interpretation">Higher temperatures lead to higher load due to cooling demand.</td>
<td class="gt_row gt_left" headers="Temperature  Takeaway">Cooling dominates in hot regimes.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Temperature  Variable_Season">Mild &amp; Cloudy / Warm &amp; Bright / Mild &amp; Sunny</td>
<td class="gt_row gt_left" headers="Temperature  Shape">U-shaped</td>
<td class="gt_row gt_left" headers="Temperature  Interpretation">Neutral near ~18–22 °C; higher demand at colder and hotter ends (transitional behaviour).</td>
<td class="gt_row gt_left" headers="Temperature  Takeaway">Balanced heating/cooling transition.</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="4" id="Temperature Range" class="gt_group_heading" data-quarto-table-cell-role="th" style="color: #00008B; font-weight: bold" scope="colgroup">Temperature Range</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="Temperature Range  Variable_Season">Cold &amp; Clear / Cold &amp; Cloudy</td>
<td class="gt_row gt_left" headers="Temperature Range  Shape">Slightly negative or flat</td>
<td class="gt_row gt_left" headers="Temperature Range  Interpretation">Minimal sensitivity; cloud cover and heating dominate.</td>
<td class="gt_row gt_left" headers="Temperature Range  Takeaway">Heating still dominant.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Temperature Range  Variable_Season">Hot &amp; Very Sunny / Mild &amp; Sunny / Warm &amp; Bright</td>
<td class="gt_row gt_left" headers="Temperature Range  Shape">Downward or weakly positive</td>
<td class="gt_row gt_left" headers="Temperature Range  Interpretation">Larger ranges (clear-sky days) coincide with strong solar generation → lower grid demand.</td>
<td class="gt_row gt_left" headers="Temperature Range  Takeaway">Clear-sky stability reduces demand.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Temperature Range  Variable_Season">Mild &amp; Cloudy</td>
<td class="gt_row gt_left" headers="Temperature Range  Shape">Slight positive</td>
<td class="gt_row gt_left" headers="Temperature Range  Interpretation">Large ranges imply cooler nights needing more heating.</td>
<td class="gt_row gt_left" headers="Temperature Range  Takeaway">Minor heating sensitivity.</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="4" id="Solar Exposure" class="gt_group_heading" data-quarto-table-cell-role="th" style="color: #00008B; font-weight: bold" scope="colgroup">Solar Exposure</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="Solar Exposure  Variable_Season">All regimes</td>
<td class="gt_row gt_left" headers="Solar Exposure  Shape">Strong negative slope</td>
<td class="gt_row gt_left" headers="Solar Exposure  Interpretation">Higher solar exposure → lower grid demand (behind-the-meter PV offset).</td>
<td class="gt_row gt_left" headers="Solar Exposure  Takeaway">Solar consistently reduces demand.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Solar Exposure  Variable_Season">Cold &amp; Cloudy</td>
<td class="gt_row gt_left" headers="Solar Exposure  Shape">Flat</td>
<td class="gt_row gt_left" headers="Solar Exposure  Interpretation">Cloudy conditions limit variation; minimal solar-driven offset.</td>
<td class="gt_row gt_left" headers="Solar Exposure  Takeaway">Little additional reduction.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Solar Exposure  Variable_Season">Hot &amp; Sunny / Mild &amp; Sunny / Warm &amp; Bright</td>
<td class="gt_row gt_left" headers="Solar Exposure  Shape">Steeper decline</td>
<td class="gt_row gt_left" headers="Solar Exposure  Interpretation">Strong PV output and daytime generation depress midday grid load ('duck curve').</td>
<td class="gt_row gt_left" headers="Solar Exposure  Takeaway">Solar effect strongest in bright conditions.</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="4" id="Interaction" class="gt_group_heading" data-quarto-table-cell-role="th" style="color: #00008B; font-weight: bold" scope="colgroup">Interaction</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="Interaction  Variable_Season">ti(Tmean_pca, Trange_pca)</td>
<td class="gt_row gt_left" headers="Interaction  Shape">Nonlinear surface</td>
<td class="gt_row gt_left" headers="Interaction  Interpretation">High demand under low Tmean + low Trange (cold, cloudy); lowest demand under high Tmean + high Trange (warm, clear).</td>
<td class="gt_row gt_left" headers="Interaction  Takeaway">Solar moderates Trange effects.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Interaction  Variable_Season">ti(Tmean_pca, solar_pca)</td>
<td class="gt_row gt_left" headers="Interaction  Shape">Nonlinear surface</td>
<td class="gt_row gt_left" headers="Interaction  Interpretation">Solar moderates temperature response — warm, sunny days yield lower net demand.</td>
<td class="gt_row gt_left" headers="Interaction  Takeaway">Solar offsets temperature-driven load.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Interaction  Variable_Season">ti(Trange_pca, solar_pca)</td>
<td class="gt_row gt_left" headers="Interaction  Shape">Nonlinear surface</td>
<td class="gt_row gt_left" headers="Interaction  Interpretation">Clear, sunny days with large range → lowest demand; cold, low-solar days → highest.</td>
<td class="gt_row gt_left" headers="Interaction  Takeaway">Solar and range jointly suppress demand.</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="4" id="Calendar" class="gt_group_heading" data-quarto-table-cell-role="th" style="color: #00008B; font-weight: bold" scope="colgroup">Calendar</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="Calendar  Variable_Season">s(doy)</td>
<td class="gt_row gt_left" headers="Calendar  Shape">Annual cyclic smooth</td>
<td class="gt_row gt_left" headers="Calendar  Interpretation">Winter &amp; summer peaks; spring/autumn troughs.</td>
<td class="gt_row gt_left" headers="Calendar  Takeaway">Reflects heating/cooling seasonal cycles.</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-gamm-grouped-interpretation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10: Grouped Interpretation of GAMM Smooth Terms
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="sec-discussion" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Discussion</h1>
<p>The results of this project demonstrate the effectiveness of a comprehensive, weather-dependent modeling approach for electricity load forecasting. Here we discuss the implications of these findings, the contributions and novelty of the work, and its limitations and potential improvements.</p>
<section id="meeting-the-objectives" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="meeting-the-objectives"><span class="header-section-number">7.1</span> Meeting the objectives</h2>
<p>Our primary objective was to forecast electricity load accurately by incorporating detailed, weather-dependent information.(see in <a href="#sec-objectives" class="quarto-xref">Section&nbsp;2.4</a>) The GAMM model achieved this effectively, with forecast error to a daily MAPE of around 3.28 %(see in <a href="#fig-gamm-forecast" class="quarto-xref">Figure&nbsp;12</a>), which is well within the industry experts’s knowledge of 3–5% for operational forecasting. This demonstrates that explicitly modeling nonlinear weather–demand relationships and integrating multiple meteorological inputs can yield substantial accuracy gains. The use of PCA to combine data from three stations proved particularly beneficial—it effectively created a unified, noise-reduced “virtual weather station” that captured regional weather dynamics more robustly while mitigating multicollinearity. Similarly, the GMM-based local season clustering enabled the model to adapt to distinct weather regimes, capturing both summer cooling and winter heating responses without forcing a single oversimplified temperature curve. This data-driven seasonal segmentation is relatively novel in load forecasting studies and showed tangible improvements in both model fit and residual structure. While a GAMM without clustering produced a marginally lower RMSE, it failed key diagnostic checks (e.g., residual autocorrelation), indicating that the clustered approach better represented underlying regime-specific behaviors critical for reliable operational forecasting.</p>
</section>
<section id="contributions-and-novelty" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="contributions-and-novelty"><span class="header-section-number">7.2</span> Contributions and novelty</h2>
<p>From a methodological perspective, this project combined several advanced techniques in a way that, to our knowledge, has not been widely reported in literature for this exact context. While GAMs have been used in load forecasting and are praised for interpretability, our work adds the element of unsupervised clustering to define seasons, and the integration of multi-source weather via PCA. This hybrid approach (mixing statistical learning and machine learning clustering) is one contribution. It required learning and applying diverse skills: data cleaning and merging (large time-series data handling), PCA and multivariate analysis, probabilistic clustering (GMM, including selection of cluster number via BIC), and sophisticated regression modeling (GAMM with <code>VarIdent</code> terms). The project thus involved a considerable degree of complexity – beyond a standard coursework exercise – pushing us to gain proficiency in multiple R packages and techniques. We also contributed to the data processing pipeline: for instance, writing functions to automate weather station data extraction and imputation, and creating visualizations (like animated plots of demand vs temperature over time) to communicate findings. These are practical contributions that could be reused in similar analyses or by the host organization (government energy department).</p>
</section>
<section id="practical-implications" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="practical-implications"><span class="header-section-number">7.3</span> Practical implications</h2>
<p>The resulting model is both accurate and interpretable, making it valuable for short-term operational forecasting and planning. System operators could use it for day-ahead demand forecasts, improving generator commitment efficiency and potentially reducing operational costs.</p>
<p>The interpretability of the GAMM provides clear insight into which weather conditions most stress the grid. For example, extremely hot, sunny days generate peak load pressures, while mild or high-solar days reduce demand via rooftop PV offset. The clustering approach could inform more flexible definitions of seasonal tariffs or demand-response triggers, based on meteorological regimes rather than rigid calendar months.</p>
<p>Furthermore, integrating multiple weather stations through PCA highlights the importance of spatially robust weather signals — a practice utilities and market operators could adopt more broadly, or extend with satellite and forecast ensemble data.</p>
</section>
<section id="limitations" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="limitations"><span class="header-section-number">7.4</span> Limitations</h2>
<p>Despite strong performance, several limitations remain:</p>
<ul>
<li>Dependence on observed weather: The model was evaluated using actual weather data; operational use would require forecast weather inputs, introducing additional uncertainty.</li>
<li>Daily granularity: The model predicts total daily demand and does not capture intraday load shapes. Extending the approach to half-hourly data would be valuable for operational scheduling.</li>
<li>Clustering design: Local seasons were derived solely from weather variables, not jointly with demand. While this avoids circularity, future work could explore hybrid clustering for potentially finer regimes.</li>
<li>Variable scope: Humidity and wind chill were excluded due to limited data but could enhance the realism of comfort-related demand modeling.</li>
<li>Evolving demand patterns: The assumption of stable weather–demand relationships may weaken over time as appliance efficiency, heating technology, and rooftop PV penetration evolve. Regular retraining is essential.</li>
<li>Extrapolation risk: GAMs extrapolate linearly beyond the training range, so forecasts under unprecedented conditions (e.g., record heat or rapid PV uptake) may be unreliable.</li>
</ul>
</section>
<section id="future-work" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="future-work"><span class="header-section-number">7.5</span> Future work</h2>
<p>Building on this foundation, several extensions are recommended:</p>
<ul>
<li><p>Operational integration: Couple the GAMM with near-term weather forecasts (e.g., NWP outputs or ensembles) to produce probabilistic day-ahead forecasts.</p></li>
<li><p>Comparative modeling: Benchmark against black-box models to assess trade-offs between accuracy and interpretability.</p></li>
<li><p>Feature enrichment: Incorporate additional meteorological features (humidity, wind chill) and distributed PV generation data for improved physical realism.</p></li>
<li><p>Spatial scalability: Apply the framework to other regions or subzones, using regionalized GMM clustering to capture diverse climate–demand dynamics. as the energy landscape evolves — with growing EV adoption and battery participation — new model terms (e.g., EV charging demand or storage discharge flags) can be introduced; the GAM framework readily accommodates such extensions.</p></li>
<li><p>Evolving energy landscape: As electric vehicle (EV) adoption and battery participation increase, new explanatory variables such as EV charging load and battery discharge indicators can be integrated. The GAMM’s flexible additive structure readily accommodates such emerging factors, ensuring continued adaptability under evolving grid conditions.</p></li>
</ul>
</section>
</section>
<section id="sec-conclusion" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Conclusion</h1>
<p>In this project, we developed a comprehensive weather-dependent load forecasting model for Victoria’s daily electricity demand, leveraging modern statistical techniques to integrate multiple data sources. Through Principal Component Analysis (PCA), we combined multi-station weather data into robust regional indicators, and through Gaussian Mixture Model (GMM) clustering, we discovered nuanced local-season regimes that improved the model’s ability to handle seasonal transitions and weather extremes. The use of a Generalized Additive Mixed Model (GAMM) enabled the capture of complex nonlinear dependencies (temperature–demand curves) and allowed for different variance by regime, yielding a well-calibrated model with near-white-noise residuals.</p>
<p>The model achieved strong predictive performance and effectively anticipated demand peaks and troughs in a period marked by high weather volatility and increasing rooftop solar PV penetration. The inclusion of solar exposure as a predictor was particularly impactful, quantifying the reduction in grid demand from distributed generation — a crucial factor in modern energy systems. The interpretability of the GAMM provided actionable insights: for example, the estimated temperature–demand curves and solar effects revealed how much additional demand arises per degree drop on cold days and how much solar exposure offsets demand on clear summer days. These insights have practical implications for system operations (e.g., triggering demand response during heatwaves) and energy policy (e.g., quantifying the benefit of efficiency measures in winter heating).</p>
<p>In summary, this study demonstrates a successful synthesis of data-driven modelling and domain knowledge in short-term load forecasting. By unifying regional weather data, objectively defining local-season clusters, and employing a flexible nonlinear model structure, we achieved both high accuracy and interpretability. These attributes make the approach practical and trustworthy for planners and policymakers who require not only reliable forecasts but also a clear understanding of demand drivers. Moving forward, adopting such methodologies can enhance grid resilience, support renewable integration, and ensure reliable power supply amid increasing weather variability and evolving consumption patterns.</p>
</section>
<section id="appendix-appendices" class="level1 unnumbered">
<h1 class="unnumbered">(APPENDIX) Appendices</h1>
<section id="app-gamm-terms" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="app-gamm-terms"><span class="header-section-number">8.1</span> (APPENDIX A) Full GAMM Term Extraction</h2>
<p>This appendix provides the full table of smooth, tensor, and parametric terms from the fitted GAMM, including significance levels and interpretation categories. For clarity, only summarized interpretations are discussed in Section <a href="#sec-Interpretation-of-Model-Components" class="quarto-xref">Section&nbsp;6.5</a>, while the detailed term listing is shown below.</p>
<div class="cell">
<div id="tbl-gamm-terms" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-gamm-terms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 32%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: center;">pval</th>
<th style="text-align: center;">Signif</th>
<th style="text-align: center;">Type</th>
<th style="text-align: left;">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">s(Tmean_pca):local_seasonCold &amp; Clear</td>
<td style="text-align: center;">0.00e+00</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Nonlinear temperature–demand response by local season</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(Tmean_pca):local_seasonCold &amp; Cloudy</td>
<td style="text-align: center;">6.93e-07</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Nonlinear temperature–demand response by local season</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(Tmean_pca):local_seasonHot &amp; Very Sunny</td>
<td style="text-align: center;">0.00e+00</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Nonlinear temperature–demand response by local season</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(Tmean_pca):local_seasonMild &amp; Cloudy</td>
<td style="text-align: center;">0.00e+00</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Nonlinear temperature–demand response by local season</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(Tmean_pca):local_seasonMild &amp; Sunny</td>
<td style="text-align: center;">0.00e+00</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Nonlinear temperature–demand response by local season</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(Tmean_pca):local_seasonWarm &amp; Bright</td>
<td style="text-align: center;">0.00e+00</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Nonlinear temperature–demand response by local season</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(Trange_pca):local_seasonCold &amp; Clear</td>
<td style="text-align: center;">4.05e-01</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Effect of diurnal temperature range by local season</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(Trange_pca):local_seasonCold &amp; Cloudy</td>
<td style="text-align: center;">9.49e-01</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Effect of diurnal temperature range by local season</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(Trange_pca):local_seasonHot &amp; Very Sunny</td>
<td style="text-align: center;">3.21e-02</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Effect of diurnal temperature range by local season</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(Trange_pca):local_seasonMild &amp; Cloudy</td>
<td style="text-align: center;">5.81e-03</td>
<td style="text-align: center;">**</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Effect of diurnal temperature range by local season</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(Trange_pca):local_seasonMild &amp; Sunny</td>
<td style="text-align: center;">4.18e-01</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Effect of diurnal temperature range by local season</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(Trange_pca):local_seasonWarm &amp; Bright</td>
<td style="text-align: center;">2.02e-02</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Effect of diurnal temperature range by local season</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(solar_pca):local_seasonCold &amp; Clear</td>
<td style="text-align: center;">4.93e-02</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Solar exposure (PV offset and daylight influence)</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(solar_pca):local_seasonCold &amp; Cloudy</td>
<td style="text-align: center;">9.76e-04</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Solar exposure (PV offset and daylight influence)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(solar_pca):local_seasonHot &amp; Very Sunny</td>
<td style="text-align: center;">4.15e-01</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Solar exposure (PV offset and daylight influence)</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(solar_pca):local_seasonMild &amp; Cloudy</td>
<td style="text-align: center;">0.00e+00</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Solar exposure (PV offset and daylight influence)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s(solar_pca):local_seasonMild &amp; Sunny</td>
<td style="text-align: center;">0.00e+00</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Solar exposure (PV offset and daylight influence)</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(solar_pca):local_seasonWarm &amp; Bright</td>
<td style="text-align: center;">8.57e-03</td>
<td style="text-align: center;">**</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Solar exposure (PV offset and daylight influence)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(Tmean_pca,Trange_pca)</td>
<td style="text-align: center;">2.31e-02</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Interaction: Temperature × Diurnal range</td>
</tr>
<tr class="even">
<td style="text-align: left;">ti(Tmean_pca,solar_pca)</td>
<td style="text-align: center;">0.00e+00</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Interaction: Temperature × Solar exposure</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ti(Trange_pca,solar_pca)</td>
<td style="text-align: center;">8.83e-02</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Interaction: Diurnal range × Solar exposure</td>
</tr>
<tr class="even">
<td style="text-align: left;">s(doy)</td>
<td style="text-align: center;">0.00e+00</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Smooth / Tensor</td>
<td style="text-align: left;">Smooth annual cycle (residual seasonality)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">2.07e-90</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Other model term</td>
</tr>
<tr class="even">
<td style="text-align: left;">t</td>
<td style="text-align: center;">2.33e-06</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Long-term or harmonic temporal trend</td>
</tr>
<tr class="odd">
<td style="text-align: left;">t_sin</td>
<td style="text-align: center;">6.83e-03</td>
<td style="text-align: center;">**</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Long-term or harmonic temporal trend</td>
</tr>
<tr class="even">
<td style="text-align: left;">t_cos</td>
<td style="text-align: center;">1.69e-38</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Long-term or harmonic temporal trend</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dow.L</td>
<td style="text-align: center;">0.00e+00</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Day-of-week fixed effect</td>
</tr>
<tr class="even">
<td style="text-align: left;">dow.Q</td>
<td style="text-align: center;">8.01e-36</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Day-of-week fixed effect</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dow.C</td>
<td style="text-align: center;">1.09e-01</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Day-of-week fixed effect</td>
</tr>
<tr class="even">
<td style="text-align: left;">dow^4</td>
<td style="text-align: center;">6.89e-66</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Day-of-week fixed effect</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dow^5</td>
<td style="text-align: center;">2.18e-45</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Day-of-week fixed effect</td>
</tr>
<tr class="even">
<td style="text-align: left;">dow^6</td>
<td style="text-align: center;">7.39e-09</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Day-of-week fixed effect</td>
</tr>
<tr class="odd">
<td style="text-align: left;">local_seasonCold &amp; Cloudy</td>
<td style="text-align: center;">7.59e-02</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Other model term</td>
</tr>
<tr class="even">
<td style="text-align: left;">local_seasonHot &amp; Very Sunny</td>
<td style="text-align: center;">3.06e-01</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Other model term</td>
</tr>
<tr class="odd">
<td style="text-align: left;">local_seasonMild &amp; Cloudy</td>
<td style="text-align: center;">9.10e-05</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Other model term</td>
</tr>
<tr class="even">
<td style="text-align: left;">local_seasonMild &amp; Sunny</td>
<td style="text-align: center;">3.15e-02</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Other model term</td>
</tr>
<tr class="odd">
<td style="text-align: left;">local_seasonWarm &amp; Bright</td>
<td style="text-align: center;">1.99e-03</td>
<td style="text-align: center;">**</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Long-term or harmonic temporal trend</td>
</tr>
<tr class="even">
<td style="text-align: left;">is_holidayTRUE</td>
<td style="text-align: center;">6.06e-80</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Public holiday effect (reduced demand)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">demand_lag1</td>
<td style="text-align: center;">1.51e-96</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Short-term persistence (previous day demand)</td>
</tr>
<tr class="even">
<td style="text-align: left;">demand_lag7</td>
<td style="text-align: center;">8.41e-05</td>
<td style="text-align: center;">***</td>
<td style="text-align: center;">Parametric</td>
<td style="text-align: left;">Weekly persistence (previous week demand)</td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-gamm-terms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11: All model terms and interpretations in GAMM (Tmean_pca / Trange_pca + local_season)
</figcaption>
</figure>
</div>
</div>
</section>
<section id="app-gamm-smooths" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="app-gamm-smooths"><span class="header-section-number">8.2</span> (APPENDIX B) Full GAMM Smooth Plots</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gamm-all-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gamm-all-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-gamm-all-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gamm-all-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: All smooth terms of the fitted GAMM
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-gamm-all-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gamm-all-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-gamm-all-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gamm-all-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: All smooth terms of the fitted GAMM
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-gamm-all-3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gamm-all-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-gamm-all-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gamm-all-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: All smooth terms of the fitted GAMM
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-gamm-all-4" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gamm-all-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="report_files/figure-html/fig-gamm-all-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gamm-all-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: All smooth terms of the fitted GAMM
</figcaption>
</figure>
</div>
</div>
</div>
<p>These figures display all smooth terms from the fitted GAMM, including temperature-, solar-, and range-related effects by local season, interaction tensors, and cyclic seasonal components. They are included here for completeness; main findings are discussed in <a href="#sec-Interpretation-of-Model-Components" class="quarto-xref">Section&nbsp;6.5</a>.</p>

</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-AEMO2024" class="csl-entry" role="listitem">
AEMO. 2024. <span>“Electricity Demand Forecasting Methodology.”</span> Australian Energy Market Operator. <a href="https://www.aer.gov.au">https://www.aer.gov.au</a>.
</div>
<div id="ref-Aquila2023" class="csl-entry" role="listitem">
Aquila, G., A. R. de Queiroz, E. de O. Pamplona, and P. R. M. Junior. 2023. <span>“Short-Term Load Forecasting for Operational Planning: Overview.”</span> <em>Energies</em> 16 (21): Article 21. <a href="https://scholars.duke.edu">https://scholars.duke.edu</a>.
</div>
<div id="ref-AEC2019" class="csl-entry" role="listitem">
Australian Energy Council. 2019. <span>“Solar Report – June 2019.”</span> <a href="https://www.energycouncil.com.au">https://www.energycouncil.com.au</a>.
</div>
<div id="ref-Baur2024" class="csl-entry" role="listitem">
Baur, L., K. Ditschuneit, M. Schambach, C. Kaymakci, T. Wollmann, and A. Sauer. 2024. <span>“Explainability and Interpretability in Electric Load Forecasting Using Machine Learning Techniques: A Review.”</span> <em>Energy and AI</em> 16: 100358. <a href="https://doi.org/10.1016/j.egyai.2024.100358">https://doi.org/10.1016/j.egyai.2024.100358</a>.
</div>
<div id="ref-CER2024" class="csl-entry" role="listitem">
Clean Energy Regulator (CER). 2024. <span>“Small-Scale Renewable Energy Scheme Data — Postcode Installations.”</span> <a href="https://cer.gov.au/markets/reports-and-data/small-scale-installation-postcode-data">https://cer.gov.au/markets/reports-and-data/small-scale-installation-postcode-data</a>.
</div>
<div id="ref-ESC2025" class="csl-entry" role="listitem">
Essential Services Commission. 2025. <span>“Draft Decision on Solar Feed-in Tariffs.”</span> <a href="https://www.pv-magazine-australia.com">https://www.pv-magazine-australia.com</a>.
</div>
<div id="ref-Fan2022" class="csl-entry" role="listitem">
Fan, J., C. Zhang, and Y. Wang. 2022. <span>“Nonlinear Models for Short-Term Electricity Demand Forecasting Under Climate Variability.”</span> <em>Energy Economics</em> 108: 105872. <a href="https://doi.org/10.1016/j.eneco.2022.105872">https://doi.org/10.1016/j.eneco.2022.105872</a>.
</div>
<div id="ref-HastieTibshirani2017" class="csl-entry" role="listitem">
Hastie, T., and R. Tibshirani. 2017. <em>Generalized Additive Models</em>. Chapman; Hall/CRC. <a href="https://www.taylorfrancis.com/books/mono/10.1201/9780203753781/generalized-additive-models-hastie">https://www.taylorfrancis.com/books/mono/10.1201/9780203753781/generalized-additive-models-hastie</a>.
</div>
<div id="ref-Misiurek2025" class="csl-entry" role="listitem">
Misiurek, Kamil, Tadeusz Olkuski, and Janusz Zyśk. 2025. <span>“Review of Methods and Models for Forecasting Electricity Consumption.”</span> <em>Energies</em> 18 (15): 4032. <a href="https://doi.org/10.3390/en18154032">https://doi.org/10.3390/en18154032</a>.
</div>
<div id="ref-Neumann2023" class="csl-entry" role="listitem">
Neumann, O., C. Heine, and W. Fichtner. 2023. <span>“Using Weather Data in Energy Time Series Forecasting: The Benefit of Input Data Transformations.”</span> <em>Energy Informatics</em> 6 (44). <a href="https://energyinformatics.springeropen.com">https://energyinformatics.springeropen.com</a>.
</div>
<div id="ref-Wood2017" class="csl-entry" role="listitem">
Wood, S. N. 2017. <em>Generalized Additive Models: An Introduction with r</em>. 2nd ed. Chapman; Hall/CRC. <a href="https://www.taylorfrancis.com/books/mono/10.1201/9781315370279/generalized-additive-models-simon-wood">https://www.taylorfrancis.com/books/mono/10.1201/9781315370279/generalized-additive-models-simon-wood</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="https://github.com/xurong980623/Weather-dependent-load-forecasting">https://github.com/xurong980623/Weather-dependent-load-forecasting</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="report_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>